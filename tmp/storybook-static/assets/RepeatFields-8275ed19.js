import{j as t}from"./TransitionGroupContext-9d36972e.js";import{R as m}from"./index-f1f749bf.js";import{a as g,D as h}from"./Play-87fed129.js";import{u as f}from"./useBeforeSave-e049f6dd.js";import{o as v,e as S,g as j,p as k,B as r,T as w,q as T,S as D,M as R,m as F,L as O}from"./papaparse.min-b66e70e7.js";import{c as b}from"./capitalize-c31f38e2.js";import{u as C}from"./pick-dba65392.js";import{A as B}from"./Alert-fd9a067a.js";import{B as I}from"./Button-352c3435.js";const p="repeatSetting",M=F({root:{"& .week-interval button":{width:"30px",minWidth:"30px",marginRight:"5px"},"& .week-select":{display:"inline",paddingTop:"3px"},"& .week-select > div":{overflow:"hidden",height:"35px"}},startSection:{display:"flex",alignItems:"center",columnGap:10},endSection:{display:"flex",alignItems:"flex-end"}});function q(a){const o=M(),[n,i]=m.useState(a.initialSetting||{period:"month",every:1,weekDay:0}),x=v(),{isReadOnly:d}=g();f(e=>{console.log(">>types/ProductPhysicalFields::sss","values",e);const s=n.key||`${S.v4().split("-").pop()}${new Date().getMilliseconds()}`;return{...e,[p]:JSON.stringify({...n,key:s})}}),C(async e=>{console.log(">>TaskRepeatField/index::","values",e);const s=await x.mutate({mutation:j`
        mutation ($triggerKey: String, $options: AWSJSON) {
          processBackground(type: $triggerKey, options: $options) {
            metadata
          }
        }
      `,variables:{triggerKey:a.triggerKey,options:JSON.stringify({disableAsync:!0,id:e.id})}});console.log(">>TaskRepeatField/index::","res",s)});const{values:y={},setFieldValue:c}=k(),l=y[a.dateField];return m.useEffect(()=>()=>{c(p,null)},[]),m.useEffect(()=>{if(l){i(e=>({...e,weekDay:new Date(l).getDay()}));return}c("start",new Date().toISOString())},[l]),console.log(">>TaskRepeatField/index::","values,state",y,n),t.jsxs(r,{className:o.root,children:[t.jsx(r,{mt:2,children:t.jsx(h,{autoOk:!0,fullWidth:!0,size:"small",variant:"inline",inputVariant:"outlined",label:"Start Date",format:"MM/dd/yyyy hh:mm a",value:l,readOnly:d,onChange:e=>{e&&c(a.dateField,e?e.toISOString():null)}})}),t.jsxs(r,{mt:1,className:o.startSection,children:[t.jsx(w,{variant:"caption",children:"Repeat every"}),t.jsx(T,{value:n.every,style:{maxWidth:70},onChange:e=>{const s=e.target.value;i(u=>({...u,every:s}))},inputProps:{disabled:d,type:"number",maxLength:"2",inputMode:"numeric",pattern:"[0-9]*"}}),t.jsx("div",{className:"week-select",children:t.jsx(D,{value:n.period,disabled:d,onChange:e=>{const s=e.target.value;i(u=>({...u,period:s}))},variant:"outlined",children:["day","week","month","year"].map(e=>t.jsxs(R,{value:e,children:[b(e),"s"]},e))})})]}),t.jsx(r,{children:n.period==="week"&&t.jsx(A,{readOnly:d,day:n.weekDay,onChange:e=>{i(s=>({...s,weekDay:e}))}})}),t.jsx(r,{children:n.period==="month"&&t.jsx(N,{recordType:a.recordType,date:l?new Date(l):new Date})})]})}function N({date:a,recordType:o}){return t.jsx(r,{mt:2,children:t.jsx(B,{severity:"info",children:t.jsxs(r,{children:[o," will repeat on ",t.jsxs("strong",{children:["day ",a.getDate()]})]})})})}function A(a){const o=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return t.jsx(r,{className:"week-interval",mt:2,children:t.jsx(O,{text:"Repeat on",children:o.map((n,i)=>t.jsx(I,{size:"small",color:"primary",disabled:a.readOnly,variant:a.day===i+1?"contained":"text",onClick:()=>{a.onChange(i+1)},children:n[0]},i))})})}export{p as R,q as a};
