import{_ as k}from"./iframe-ed7f5a3f.js";import{j as e,a as ye,g as je,s as ce,d as ue,u as ge,_ as ve,c as Z,b as Ie}from"./TransitionGroupContext-9d36972e.js";import{r as F,R as n}from"./index-f1f749bf.js";import{d as Le,u as Se,s as C,M as Te,t as _e}from"./pick-dba65392.js";import{U as ke,a as Me}from"./UserFormV2-0b48237f.js";import{bH as Ce,bJ as B,$ as we,a6 as Y,f as de,B as I,Z as me,aq as X,cg as Ae,b7 as De,ch as Ee,ci as $e,P as Oe,cj as Re,M as Pe,J as $,aj as Fe,ck as Ue,V as Be,cl as We,cm as Ve,d as ee,ae as te,i as se,u as J,g as Ne,p as ze,Y as Qe,e as qe,l as pe,b as re,N as He,Q as ae,O as Ge,W as Je,o as Ke,cn as Ze,bx as Ye,ay as Xe,co as et,at as tt,a3 as st}from"./papaparse.min-b66e70e7.js";import{d as fe,e as be,E as rt,i as at,f as V,u as oe,s as ot}from"./index-bcfaa842.js";import{g as S}from"./_baseForOwn-9b89c4b6.js";import{u as U}from"./react-router-19e5b27c.js";import{e as N,w as xe,S as ie,O as it,Q as nt}from"./Play-87fed129.js";import lt from"./index-6ede752a.js";import{b as ct,B as O}from"./Button-352c3435.js";import{a as ut,b as ne,c as E,d as dt}from"./TableRow-00aadd87.js";import{T as mt}from"./TableHead-dd1583ce.js";import{a as G}from"./assertThisInitialized-ad1db8e7.js";import{d as pt}from"./DeleteForeverOutlined-2dc96511.js";import{u as ft}from"./ProjectLink-987015ba.js";import{c as bt,u as xt}from"./VewJobDetails.story-c6ae2e88.js";import"./index-96c5f47c.js";import{R as ht}from"./index-5757e0d6.js";import"../sb-preview/runtime.js";import"./_commonjsHelpers-042e6b4d.js";import"./filter-f99df4e5.js";import"./LocalizationProvider-a287304f.js";import"./index-61adb48a.js";import"./useGetProjectSummaryFields-0ab32aca.js";import"./SelectEsModelInput-d580a9f7.js";import"./Link-c687dc07.js";import"./react-router-dom-60ea8218.js";import"./tiny-invariant-dd7d57d2.js";import"./_arrayIncludes-2cfb33ae.js";import"./useIncludeFieldNames-35a180a9.js";import"./Save-b67fa0ac.js";import"./index-147ad7aa.js";import"./Add-be7f5660.js";import"./uniq-0d482d7b.js";import"./MultipleSelectFieldInput-d0cee4a2.js";import"./Person-5be09a1e.js";import"./auth-5b6b0f80.js";import"./useBeforeSave-e049f6dd.js";import"./find-8750f979.js";import"./index.esm-bf21a293.js";import"./index-18188c67.js";import"./zod-575fe4a8.js";import"./CloudUpload-462faa0c.js";import"./SyncEagleDevTool-4c34bdb8.js";import"./index-ce960f89.js";import"./userGroups-edff3f7b.js";import"./index-f70ce446.js";import"./searchUsers-04324aeb.js";import"./useFetchMore-be228481.js";import"./useTagSearch-f4fcfbe9.js";import"./Skeleton-cd6f071e.js";import"./useMutation-64d5b683.js";import"./isPlainObject-07477f89.js";import"./debounce-213cd46f.js";import"./index-4d501b15.js";import"./isNativeReflectConstruct-05c29d01.js";import"./cloneDeep-91467704.js";import"./index-72884e22.js";import"./index-356e4a49.js";import"./stories-1f769a10.js";import"./index-63a3e378.js";import"./ExpandMore-79a3c159.js";import"./uniqBy-baac1626.js";import"./RemoveCircle-617bdac2.js";import"./index-b769406f.js";import"./DragIndicator-582939ba.js";import"./capitalize-c31f38e2.js";import"./isString-2f2f79c0.js";import"./times-069ea398.js";import"./_castFunction-353dfc26.js";import"./TaskForm-863cdb73.js";import"./RepeatFields-8275ed19.js";import"./Alert-fd9a067a.js";import"./TaskAssignees-858ea3c9.js";import"./useTaskAssignees-9f1fd5d3.js";import"./github-91d085b0.js";import"./SortUpIcon-3aecf5f0.js";import"./OpportunityLink-b32d0c35.js";import"./index-9d3afdfc.js";import"./index-79afbab1.js";import"./Check-78df5e8e.js";import"./bundle-053bdffd.js";import"./MilestoneIcon-61fb6e69.js";import"./Trash-822e65ce.js";import"./index-5d349c56.js";import"./EstimateEditorPopover-b8debf9a.js";import"./AssigneeEditorPopover-2b4e6473.js";import"./ToggleButtonGroup-93d9af56.js";import"./index-71ed01a9.js";import"./index-4d31058a.js";import"./Undo-33c7aa7a.js";import"./camelCase-4e7e8b23.js";import"./AuditLogsNoBreadCrumbs-8da9c0ce.js";import"./ExpenseView-2f5d1473.js";import"./MenuOptions-0bc3bb51.js";import"./LocationBeFormBody-c033b2b3.js";import"./reduce-4f6f1985.js";const yt=Ce(e.jsx("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}),"ArrowDownward");function jt(t){return je("MuiTableSortLabel",t)}const gt=ye("MuiTableSortLabel",["root","active","icon","iconDirectionDesc","iconDirectionAsc"]),q=gt,vt=["active","children","className","direction","hideSortIcon","IconComponent"],It=t=>{const{classes:a,direction:r,active:s}=t,o={root:["root",s&&"active"],icon:["icon",`iconDirection${ue(r)}`]};return Ie(o,jt,a)},Lt=ce(ct,{name:"MuiTableSortLabel",slot:"Root",overridesResolver:(t,a)=>{const{ownerState:r}=t;return[a.root,r.active&&a.active]}})(({theme:t})=>({cursor:"pointer",display:"inline-flex",justifyContent:"flex-start",flexDirection:"inherit",alignItems:"center","&:focus":{color:(t.vars||t).palette.text.secondary},"&:hover":{color:(t.vars||t).palette.text.secondary,[`& .${q.icon}`]:{opacity:.5}},[`&.${q.active}`]:{color:(t.vars||t).palette.text.primary,[`& .${q.icon}`]:{opacity:1,color:(t.vars||t).palette.text.secondary}}})),St=ce("span",{name:"MuiTableSortLabel",slot:"Icon",overridesResolver:(t,a)=>{const{ownerState:r}=t;return[a.icon,a[`iconDirection${ue(r.direction)}`]]}})(({theme:t,ownerState:a})=>G({fontSize:18,marginRight:4,marginLeft:4,opacity:0,transition:t.transitions.create(["opacity","transform"],{duration:t.transitions.duration.shorter}),userSelect:"none"},a.direction==="desc"&&{transform:"rotate(0deg)"},a.direction==="asc"&&{transform:"rotate(180deg)"})),Tt=F.forwardRef(function(a,r){const s=ge({props:a,name:"MuiTableSortLabel"}),{active:o=!1,children:l,className:f,direction:b="asc",hideSortIcon:c=!1,IconComponent:u=yt}=s,j=ve(s,vt),p=G({},s,{active:o,direction:b,hideSortIcon:c,IconComponent:u}),d=It(p);return e.jsxs(Lt,G({className:Z(d.root,f),component:"span",disableRipple:!0,ownerState:p,ref:r},j,{children:[l,c&&!o?null:e.jsx(St,{as:u,className:Z(d.icon),ownerState:p})]}))}),_t=Tt;function kt(t){const[a,r]=n.useState({count:null});return n.useEffect(()=>{const s=async()=>{const o=await Y.list(`attachments/${t}`);r(l=>({...l,count:o.length}))};return B.listen("new-attachment",s),B.listen("remove-attachment",s),()=>{B.remove("new-attachment",s),B.remove("remove-attachment",s)}},[t]),we(async s=>{if(!t)return;const o=await Y.list(`attachments/${t}`);s()&&r(l=>({...l,count:o.length}))},[t]),a}function Mt(){const{userId:t}=U(),[a]=n.useState({refDate:new Date}),{startInterval:r,endInterval:s}=n.useMemo(()=>({startInterval:fe(a.refDate),endInterval:be(a.refDate)}),[a.refDate]),o=de({key:"MEMBER_SUMMARY_ESQ",index:"allocation",body:{size:0,query:{bool:{must:[{match:{memberId:t}},{range:{date:{gte:r,lte:s}}}]}},aggs:{TOTAL_THIS_MONTH:{sum:{field:"duration"}}}}});return console.log(">>member/Member::","esQ",o),e.jsx("div",{children:e.jsxs(I,{width:"320px",bgcolor:"#F4F5F7",padding:"10px 15px",children:["Total allocations this month:"," ",e.jsx(I,{component:"span",fontSize:"large",fontWeight:"bold",children:S(o,"result.aggregations.TOTAL_THIS_MONTH.value","")})," ","h"]})})}const Ct=xe(me);function wt(){const{userId:t}=U(),a={};return e.jsx("div",{children:e.jsx(Ct,{name:"user",initialValues:a,id:t,withTags:!1,canDelete:!1,headerProps:{showDivider:!1,forceShowActions:!0},children:e.jsx(lt,{field:"availabilityList",children:e.jsxs(I,{display:"flex",children:[e.jsx(I,{width:"250px",children:e.jsx(N,{name:"availabilityList_maxHoursPerWeek",label:"Max Hours Per Week",fullWidth:!0})}),e.jsx(I,{width:"250px",ml:2,children:e.jsx(N,{name:"availabilityList_maxHoursPerMonth",label:"Max Hours Per Month",fullWidth:!0})})]})})})})}const At=({options:t,onMenuItemClick:a=()=>{},onClick:r=()=>{},fixed:s=!1,...o})=>{const[l,f]=n.useState(!1),b=n.useRef(null),[c,u]=n.useState(0),j=(i,h)=>{s?r(h):u(h),f(!1),a(i,h)},p=i=>{i&&i.stopPropagation(),f(h=>!h)},d=i=>{b.current&&b.current.contains(i.target)||f(!1)};return e.jsx(X,{container:!0,direction:"column",alignItems:"center",children:e.jsxs(X,{item:!0,xs:12,children:[e.jsxs(Ae,{variant:"contained",ref:b,"aria-label":"split button",...o,children:[e.jsx(O,{onClick:()=>r(c),children:t[c]}),t>1&&e.jsx(O,{size:"small","aria-controls":l?"split-button-menu":void 0,"aria-expanded":l?"true":void 0,"aria-label":"select merge strategy","aria-haspopup":"menu",onClick:p,children:e.jsx(De,{})})]}),e.jsx(Ee,{style:{zIndex:100},open:l,anchorEl:b.current,role:void 0,transition:!0,disablePortal:!0,children:({TransitionProps:i,placement:h})=>e.jsx($e,{...i,style:{transformOrigin:h==="bottom"?"center top":"center bottom"},children:e.jsx(Oe,{children:e.jsx(rt,{onClickAway:d,children:e.jsx(Re,{id:"split-button-menu",children:t.map((v,L)=>{if(!(s&&L===0))return e.jsx(Pe,{selected:L===c&&!s,onClick:T=>j(T,L),children:v},v)})})})})})})]})})},Dt=({data:t=[],loading:a=!1,children:r,headProps:s={},bodyProps:o={},rowActions:l=[],sort:f={field:"id",direction:"asc"},onSortSelect:b,onRowActionSelect:c,onRowActionRender:u,onRowClick:j=()=>{},getRowClassName:p,rowProps:d={},recordPath:i,...h})=>{const[v,L]=n.useState([]),[T,w]=n.useState({}),z=x=>{if(u){const m=u(x);return m?e.jsx(E,{children:m}):e.jsx(E,{})}return e.jsx(E,{children:e.jsx(At,{options:l,onClick:m=>c({index:m,...x}),fixed:!0})})};return n.useEffect(()=>{const x=[],m=[];n.Children.map(r,(y,A)=>{const M=y==null?void 0:y.props;if(!M)return;const{dataId:D,label:K,render:Q,sortable:R,...P}=M;switch(y.type){case"text":case"number":x.push({key:D,sortable:R,render:(g,_)=>Q?Q(g,_):g&&`${$(g)}`});break;case"boolean":x.push({key:D,sortable:R,render:g=>g?e.jsx(We,{color:"primary",...P}):e.jsx(Ve,{color:"secondary",...P})});break;case"array":x.push({key:D,sortable:R,render:g=>g&&g.map((_,he)=>e.jsx(Be,{style:{margin:5},label:$(_),...P},_+he))});break;case"column":x.push({key:D,sortable:R,render:(...g)=>Q(...g)});break;case"date":x.push({key:D,sortable:R,render:g=>{const _=new Date(g);return g&&at(_)&&P.format?e.jsx(Fe,{title:_.toLocaleString(),primary:V(_,P.format),secondary:Ue(_,{addSuffix:!0})}):g}});break}K&&(m[D||A]=K)}),L(x),w(m)},[r]),e.jsxs(ut,{...h,children:[e.jsx(mt,{...s,children:e.jsx(ne,{children:!a&&e.jsxs(e.Fragment,{children:[v.map((x,m)=>{const y=T[x.key||m];return e.jsx(E,{children:x.sortable?e.jsx(_t,{direction:f.direction,active:x.key===f.field,onClick:()=>b(x.key),children:y||$(x.key)}):y||$(x.key)},`${x.key} - ${m}`)}),l.length>0&&e.jsx(E,{children:"Actions"})]})})}),e.jsx(dt,{...o,children:!a&&t.map(x=>{const m=i?S(x,i):x;return F.createElement(ne,{...d,hover:!!j,key:m.id,className:p?p(m,x):d.className},v.map((y,A)=>e.jsx(E,{onClick:()=>j(m),children:y.render(S(m,y.key&&y.key),m,x)},`${m.id}-${y.key}-${A}`)),(l==null?void 0:l.length)>0&&z(m))})})]})},W="text",Et="column",$t=Dt,H=xe(me);function Ot(t){const a=J(Ne`
      query MEMBER_INFO($id: ID!) {
        getUser(id: $id) {
          id
          fullname
          group
          skillList
        }
      }
    `,{variables:{id:t},skip:!t});return n.useMemo(()=>{var s;const r=((s=a.data)==null?void 0:s.getUser)||{};return{...r,kpi:JSON.parse(r.kpi||"{}")}},[a])}function Rt(){const{userId:t}=U(),[a,r]=n.useState(!1),[s,o]=n.useState(!1),[l,f]=n.useState(null),[b,c]=n.useState(null),u=b||[],j={dateAttained:""},p=Ot(t);return n.useEffect(()=>{if(b===null&&(p!=null&&p.id)){const d=p!=null&&p.skillList?JSON.parse(p==null?void 0:p.skillList):[];c(d)}},[b,p]),e.jsx(e.Fragment,{children:e.jsx(H,{id:t,name:"user",title:"Skill",withTags:!1,canDelete:!1,readOnly:!1,editOnly:!0,headerProps:{showDivider:!1,forceShowActions:!0},beforeSave:d=>({userId:t,...d,skillList:JSON.stringify(u)}),children:e.jsxs(e.Fragment,{children:[e.jsx(ee.Consumer,{children:d=>!d.state.readOnly&&e.jsxs(I,{pr:1,mb:2,marginTop:"-95px",display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(I,{}),e.jsx(O,{color:"primary",variant:"contained",onClick:()=>{r(!0)},children:"Add Skill ➕"})]})}),e.jsx(te,{minWidth:"lg",maxWidth:"lg",onClose:()=>{r(!1)},open:a,children:e.jsx(H,{name:"user",title:"Skill",submitButtonLabel:"Add Skill",hideActionButtons:!0,withTags:!1,canDelete:!1,beforeSave:d=>(d.dateAttained&&(d.dateAttained=new Date(d.dateAttained)),d),children:e.jsx(le,{skills:u||[],openCreateDialog:!0,setSkills:c,onCancel:r,setOpenCreateDialog:r})})}),e.jsx(te,{minWidth:"lg",maxWidth:"lg",onClose:()=>{o(!1)},open:s,children:e.jsx(H,{name:"user",title:"Skill",submitButtonLabel:"Add Skill",hideActionButtons:!0,withTags:!1,canDelete:!1,beforeSave:d=>(d.dateAttained&&(d.dateAttained=new Date(d.dateAttained)),d),children:e.jsx(le,{skills:u||[],openEditDialog:!0,chosenSkill:s?l:null,onCancel:o,setOpenEditDialog:o,setSkills:c})})}),e.jsx(I,{children:e.jsx(ee.Consumer,{children:d=>e.jsxs($t,{data:u||[],initialValues:j,onRowClick:i=>{d.state.readOnly||(f(i),o(!0))},rowProps:{style:{cursor:"pointer"}},onRowActionSelect:console.log,children:[e.jsx(W,{label:"Skill",dataId:"skill",render:i=>i||"-"}),e.jsx(W,{label:"Level",dataId:"level",render:i=>i||"-"}),e.jsx(W,{label:"Date Attained",dataId:"dateAttained",render:i=>i?new Date(i).toLocaleDateString():"-"}),e.jsx(W,{label:"Comments",dataId:"comments",render:i=>i||"-"}),e.jsx(Et,{dataId:"id",label:"Actions",width:"200px",render:(i,h)=>!d.state.readOnly&&e.jsxs(e.Fragment,{children:[e.jsx(se,{onClick:v=>{v.stopPropagation(),f(h),o(!0)},size:"large",children:e.jsx(Le,{})}),e.jsx(se,{onClick:v=>{v.stopPropagation();const L=u==null?void 0:u.filter(T=>T.id!==i);c([...L])},size:"large",children:e.jsx(pt,{})})]})})]})})})]})})})}const le=({setOpenCreateDialog:t,setOpenEditDialog:a,setSkills:r,chosenSkill:s,openEditDialog:o,openCreateDialog:l,onCancel:f,skills:b})=>{var d;const{values:c={},setFieldValue:u}=ze(),[j]=Qe(["kwTeamMemberSkillsList"]);n.useEffect(()=>{Object.keys(c).length>0&&(u("skill",s==null?void 0:s.skill),u("dateAttained",s==null?void 0:s.dateAttained),u("level",s==null?void 0:s.level),u("comments",s==null?void 0:s.comments),u("id",s==null?void 0:s.id))},[s]);const p=(d=j.kwTeamMemberSkillsList)==null?void 0:d.filter(i=>!(b||[]).find(h=>h.skill===i?i:null));return e.jsxs(e.Fragment,{children:[e.jsx(ie,{name:"skill",options:p}),e.jsx(ie,{name:"level",options:["1","2","3","4","5"]}),e.jsx(N,{type:"date",fullWidth:!0,name:"dateAttained"}),e.jsx(N,{name:"comments",multiline:!0}),e.jsxs(I,{style:{display:"grid",gridTemplateColumns:"repeat(2, auto )",gridColumnGap:10,justifyContent:"end"},children:[e.jsx(O,{fullWidth:!0,variant:"outlined",onClick:()=>{f(!1)},children:"Cancel"}),e.jsxs(O,{"data-testid":"beform-submit-button",fullWidth:!0,variant:"contained",color:"primary",onClick:()=>{if(o){const i=(b==null?void 0:b.filter(h=>h.id!==c.id))||[];i.unshift(c),r(i),a(!1)}if(l){const{comments:i,dateAttained:h,level:v,skill:L}=c,T={id:qe.v4(),comments:i,dateAttained:h,level:v,skill:L};r(w=>[...w,T]),t(!1)}},children:[o?"Edit":"Add"," Skill"]})]})]})};function Pt({userId:t}){var b;console.log(">>UserLocation/UserLocationList::","userId",t);const a=n.useRef(null),[r,s]=n.useState({selectedItem:null}),o=J(pe`
      query QUERY_USR_LOC_LIST($filter: SearchableUserLocationFilterInput) {
        list: searchUserLocations(filter: $filter) {
          items {
            id
            name
            type
            locationId
            location {
              id
              address1
              address2
              type
              suburb
            }
          }
        }
      }
    `,{variables:{filter:{userId:{eq:t}}}}),l=n.useCallback(async c=>{s(u=>({...u,selectedItem:c})),await re.delay(200),a.current.open()},[]);console.log(">>UserLocation/UserLocationList::","usrLocQ",o);const f=S(o,"data.list.items",[]);return e.jsxs("div",{children:[e.jsxs(I,{display:"flex",justifyContent:"space-between",mb:2,children:[e.jsx("div",{}),e.jsx("div",{children:e.jsx(O,{variant:"contained",color:"primary",onClick:async()=>{s(c=>({...c,selectedItem:null})),await re.delay(200),a.current.open()},children:"Add Location"})})]}),e.jsxs(He,{loading:o.loading,data:f,onRowClick:l,children:[e.jsx(ae,{width:"150px",dataId:"name",label:"Name"}),e.jsx(ae,{width:"150px",dataId:"type",label:"Type",render:c=>$(c)}),e.jsx(Ge,{dataId:"location",render:Ut})]}),e.jsx(Je,{scroll:"body",variant:"dialog",ref:a,maxWidth:"md",dialogProps:{maxWidth:"sm",fullWidth:!0},children:e.jsx(bt,{id:(b=r.selectedItem)==null?void 0:b.locationId,onCancel:()=>{a.current.close()},onSubmit:()=>{a.current.close(),o.refetch()},children:e.jsx(Ft,{selectedItem:r.selectedItem,userId:t})})})]})}function Ft({selectedItem:t,userId:a}){const r=Ke();return Se(async s=>{console.log(">>UserLocation/UserLocationList::sss","savedValues",s);const o={name:s.name,type:s.type,userId:a,locationId:s.id};let l="create";t&&(o.id=t.id,l="update");const f=await r.mutate({mutation:pe`
        mutation($input: ${$(l)}UserLocationInput!) {
          ${l}UserLocation(input: $input) {
            id
          }
        }
      `,variables:{input:o}});console.log(">>UserLocation/UserLocationList::","res",f)}),null}function Ut(t){return t?e.jsxs(I,{component:"span",display:"flex",alignItems:"center",children:[e.jsx(Ze,{})," ",t.address1," ",t.address2,",",t.suburb,",",t.state,",",t.postcode,",",t.country]}):null}const Bt=async t=>{var f,b;const{userId:a,status:r}=t;return(((b=(f=(await Ye.query({query:Xe,variables:{filter:{userId:{eq:a}}}})).data)==null?void 0:f.result)==null?void 0:b.items)||[]).filter(c=>{var u,j;return r==="OPEN"?((u=c==null?void 0:c.task)==null?void 0:u.status)!=="COMPLETE":((j=c==null?void 0:c.task)==null?void 0:j.status)===r}).length},Wt=(t,a={})=>{const r=J(et,{variables:{id:t},skip:!t,...a});return[F.useMemo(()=>{var l,f;if(!((l=r.data)!=null&&l.result))return;const o=structuredClone((f=r.data)==null?void 0:f.result);return o.signatures=`member/signatures/${o==null?void 0:o.id}.jpeg`,o},[r.data]),r]},Vt=n.lazy(()=>k(()=>import("./index-d96cdba2.js"),["./index-d96cdba2.js","./TransitionGroupContext-9d36972e.js","./index-f1f749bf.js","./_commonjsHelpers-042e6b4d.js","./assertThisInitialized-ad1db8e7.js","./papaparse.min-b66e70e7.js","./_arrayIncludes-2cfb33ae.js","./_baseForOwn-9b89c4b6.js","./index-bcfaa842.js","./index-96c5f47c.js","./isNativeReflectConstruct-05c29d01.js","./Button-352c3435.js","./isPlainObject-07477f89.js","./debounce-213cd46f.js","./iframe-ed7f5a3f.js","./index-4d501b15.js","./papaparse-cdbe7e6d.css","./Play-87fed129.js","./react-router-19e5b27c.js","./tiny-invariant-dd7d57d2.js","./filter-f99df4e5.js","./LocalizationProvider-a287304f.js","./react-router-dom-60ea8218.js","./uniq-0d482d7b.js","./cloneDeep-91467704.js","./index-6ede752a.js","./useBeforeSave-e049f6dd.js","./useIncludeFieldNames-35a180a9.js","./Add-be7f5660.js","./SelectEsModelInput-d580a9f7.js","./index-864004f3.js"],import.meta.url)),Nt=n.lazy(()=>k(()=>import("./MemberTasks-9dcd3068.js"),["./MemberTasks-9dcd3068.js","./TransitionGroupContext-9d36972e.js","./index-f1f749bf.js","./_commonjsHelpers-042e6b4d.js","./assertThisInitialized-ad1db8e7.js","./papaparse.min-b66e70e7.js","./_arrayIncludes-2cfb33ae.js","./_baseForOwn-9b89c4b6.js","./index-bcfaa842.js","./index-96c5f47c.js","./isNativeReflectConstruct-05c29d01.js","./Button-352c3435.js","./isPlainObject-07477f89.js","./debounce-213cd46f.js","./iframe-ed7f5a3f.js","./index-4d501b15.js","./papaparse-cdbe7e6d.css","./VewJobDetails.story-c6ae2e88.js","./index-72884e22.js","./index-147ad7aa.js","./index-356e4a49.js","./stories-1f769a10.js","./index-63a3e378.js","./index.esm-bf21a293.js","./index-ce960f89.js","./index-f70ce446.js","./zod-575fe4a8.js","./Add-be7f5660.js","./userGroups-edff3f7b.js","./react-router-19e5b27c.js","./tiny-invariant-dd7d57d2.js","./ProjectLink-987015ba.js","./Play-87fed129.js","./filter-f99df4e5.js","./LocalizationProvider-a287304f.js","./react-router-dom-60ea8218.js","./uniq-0d482d7b.js","./cloneDeep-91467704.js","./pick-dba65392.js","./index-61adb48a.js","./useGetProjectSummaryFields-0ab32aca.js","./SelectEsModelInput-d580a9f7.js","./Link-c687dc07.js","./useIncludeFieldNames-35a180a9.js","./Save-b67fa0ac.js","./SyncEagleDevTool-4c34bdb8.js","./searchUsers-04324aeb.js","./find-8750f979.js","./index-18188c67.js","./useFetchMore-be228481.js","./useTagSearch-f4fcfbe9.js","./Skeleton-cd6f071e.js","./ExpandMore-79a3c159.js","./uniqBy-baac1626.js","./RemoveCircle-617bdac2.js","./index-b769406f.js","./DragIndicator-582939ba.js","./TableRow-00aadd87.js","./TableHead-dd1583ce.js","./capitalize-c31f38e2.js","./isString-2f2f79c0.js","./Person-5be09a1e.js","./times-069ea398.js","./_castFunction-353dfc26.js","./TaskForm-863cdb73.js","./RepeatFields-8275ed19.js","./useBeforeSave-e049f6dd.js","./Alert-fd9a067a.js","./TaskAssignees-858ea3c9.js","./useTaskAssignees-9f1fd5d3.js","./github-91d085b0.js","./SortUpIcon-3aecf5f0.js","./OpportunityLink-b32d0c35.js","./index-9d3afdfc.js","./index-79afbab1.js","./Check-78df5e8e.js","./bundle-053bdffd.js","./MilestoneIcon-61fb6e69.js","./Trash-822e65ce.js","./index-5d349c56.js","./EstimateEditorPopover-b8debf9a.js","./AssigneeEditorPopover-2b4e6473.js","./ToggleButtonGroup-93d9af56.js","./index-0d862032.css","./index-71ed01a9.js","./index-4d31058a.js","./Undo-33c7aa7a.js","./camelCase-4e7e8b23.js","./AuditLogsNoBreadCrumbs-8da9c0ce.js","./ExpenseView-2f5d1473.js","./MenuOptions-0bc3bb51.js","./MultipleSelectFieldInput-d0cee4a2.js","./LocationBeFormBody-c033b2b3.js","./reduce-4f6f1985.js","./VewJobDetails-6c7b73a1.css"],import.meta.url)),zt=n.lazy(()=>k(()=>import("./MemberIntervals-89200971.js"),["./MemberIntervals-89200971.js","./TransitionGroupContext-9d36972e.js","./index-f1f749bf.js","./_commonjsHelpers-042e6b4d.js","./assertThisInitialized-ad1db8e7.js","./papaparse.min-b66e70e7.js","./_arrayIncludes-2cfb33ae.js","./_baseForOwn-9b89c4b6.js","./index-bcfaa842.js","./index-96c5f47c.js","./isNativeReflectConstruct-05c29d01.js","./Button-352c3435.js","./isPlainObject-07477f89.js","./debounce-213cd46f.js","./iframe-ed7f5a3f.js","./index-4d501b15.js","./papaparse-cdbe7e6d.css","./useFetchMore-be228481.js","./Play-87fed129.js","./react-router-19e5b27c.js","./tiny-invariant-dd7d57d2.js","./filter-f99df4e5.js","./LocalizationProvider-a287304f.js","./react-router-dom-60ea8218.js","./uniq-0d482d7b.js","./cloneDeep-91467704.js","./SortUpIcon-3aecf5f0.js","./Stop-d43309a7.js","./index-66552ec6.js","./ProjectLink-987015ba.js","./pick-dba65392.js","./index-61adb48a.js","./useGetProjectSummaryFields-0ab32aca.js","./SelectEsModelInput-d580a9f7.js","./Link-c687dc07.js","./useIncludeFieldNames-35a180a9.js","./Save-b67fa0ac.js","./index-147ad7aa.js","./Add-be7f5660.js","./index-864004f3.js"],import.meta.url)),Qt=n.lazy(()=>k(()=>import("./MemberAllocations-98a37f8c.js"),["./MemberAllocations-98a37f8c.js","./TransitionGroupContext-9d36972e.js","./index-f1f749bf.js","./_commonjsHelpers-042e6b4d.js","./assertThisInitialized-ad1db8e7.js","./SchedGrid-97551359.js","./iframe-ed7f5a3f.js","./papaparse.min-b66e70e7.js","./_arrayIncludes-2cfb33ae.js","./_baseForOwn-9b89c4b6.js","./index-bcfaa842.js","./index-96c5f47c.js","./isNativeReflectConstruct-05c29d01.js","./Button-352c3435.js","./isPlainObject-07477f89.js","./debounce-213cd46f.js","./index-4d501b15.js","./papaparse-cdbe7e6d.css","./index-61adb48a.js","./pick-dba65392.js","./Play-87fed129.js","./react-router-19e5b27c.js","./tiny-invariant-dd7d57d2.js","./filter-f99df4e5.js","./LocalizationProvider-a287304f.js","./react-router-dom-60ea8218.js","./uniq-0d482d7b.js","./cloneDeep-91467704.js","./useGetProjectSummaryFields-0ab32aca.js","./SelectEsModelInput-d580a9f7.js","./Link-c687dc07.js","./useIncludeFieldNames-35a180a9.js","./Save-b67fa0ac.js","./index-147ad7aa.js","./Add-be7f5660.js","./useFetchMore-be228481.js","./Check-78df5e8e.js","./ProjectLink-987015ba.js","./index-4d31058a.js","./index-79afbab1.js","./OpportunityLink-b32d0c35.js","./app_constants-e80240cb.js","./index-34b70f05.js","./index-9ae6381b.js","./isEqual-86613f76.js","./reduce-4f6f1985.js","./Alert-fd9a067a.js","./Trash-822e65ce.js"],import.meta.url)),qt=n.lazy(()=>k(()=>import("./index-71ed01a9.js"),["./index-71ed01a9.js","./TransitionGroupContext-9d36972e.js","./index-f1f749bf.js","./_commonjsHelpers-042e6b4d.js","./assertThisInitialized-ad1db8e7.js","./papaparse.min-b66e70e7.js","./_arrayIncludes-2cfb33ae.js","./_baseForOwn-9b89c4b6.js","./index-bcfaa842.js","./index-96c5f47c.js","./isNativeReflectConstruct-05c29d01.js","./Button-352c3435.js","./isPlainObject-07477f89.js","./debounce-213cd46f.js","./iframe-ed7f5a3f.js","./index-4d501b15.js","./papaparse-cdbe7e6d.css","./Play-87fed129.js","./react-router-19e5b27c.js","./tiny-invariant-dd7d57d2.js","./filter-f99df4e5.js","./LocalizationProvider-a287304f.js","./react-router-dom-60ea8218.js","./uniq-0d482d7b.js","./cloneDeep-91467704.js","./index-4d31058a.js","./Undo-33c7aa7a.js","./camelCase-4e7e8b23.js","./capitalize-c31f38e2.js","./SelectEsModelInput-d580a9f7.js","./useIncludeFieldNames-35a180a9.js","./pick-dba65392.js","./index-61adb48a.js","./useGetProjectSummaryFields-0ab32aca.js","./Link-c687dc07.js","./Save-b67fa0ac.js","./index-147ad7aa.js","./Add-be7f5660.js","./useTagSearch-f4fcfbe9.js","./useFetchMore-be228481.js"],import.meta.url)),Ht=n.lazy(()=>k(()=>import("./index-32571032.js"),["./index-32571032.js","./TransitionGroupContext-9d36972e.js","./index-f1f749bf.js","./_commonjsHelpers-042e6b4d.js","./assertThisInitialized-ad1db8e7.js","./index-bcfaa842.js","./index-96c5f47c.js","./isNativeReflectConstruct-05c29d01.js","./papaparse.min-b66e70e7.js","./_arrayIncludes-2cfb33ae.js","./_baseForOwn-9b89c4b6.js","./Button-352c3435.js","./isPlainObject-07477f89.js","./debounce-213cd46f.js","./iframe-ed7f5a3f.js","./index-4d501b15.js","./papaparse-cdbe7e6d.css","./find-8750f979.js","./index.esm-bf21a293.js","./index-18188c67.js","./index-61adb48a.js","./LocalizationProvider-a287304f.js","./filter-f99df4e5.js","./pick-dba65392.js","./Play-87fed129.js","./react-router-19e5b27c.js","./tiny-invariant-dd7d57d2.js","./react-router-dom-60ea8218.js","./uniq-0d482d7b.js","./cloneDeep-91467704.js","./useGetProjectSummaryFields-0ab32aca.js","./SelectEsModelInput-d580a9f7.js","./Link-c687dc07.js","./useIncludeFieldNames-35a180a9.js","./Save-b67fa0ac.js","./index-147ad7aa.js","./Add-be7f5660.js","./SyncEagleDevTool-4c34bdb8.js","./zod-575fe4a8.js","./index-ce960f89.js","./userGroups-edff3f7b.js","./index-f70ce446.js","./searchUsers-04324aeb.js","./useFetchMore-be228481.js","./useTagSearch-f4fcfbe9.js","./Skeleton-cd6f071e.js"],import.meta.url)),Gt=n.lazy(()=>k(()=>import("./ThisWeek-07920f71.js"),["./ThisWeek-07920f71.js","./TransitionGroupContext-9d36972e.js","./index-f1f749bf.js","./_commonjsHelpers-042e6b4d.js","./assertThisInitialized-ad1db8e7.js","./index-bcfaa842.js","./index-96c5f47c.js","./isNativeReflectConstruct-05c29d01.js","./ProjectSelect-6c06b3ef.js","./Play-87fed129.js","./papaparse.min-b66e70e7.js","./_arrayIncludes-2cfb33ae.js","./_baseForOwn-9b89c4b6.js","./Button-352c3435.js","./isPlainObject-07477f89.js","./debounce-213cd46f.js","./iframe-ed7f5a3f.js","./index-4d501b15.js","./papaparse-cdbe7e6d.css","./react-router-19e5b27c.js","./tiny-invariant-dd7d57d2.js","./filter-f99df4e5.js","./LocalizationProvider-a287304f.js","./react-router-dom-60ea8218.js","./uniq-0d482d7b.js","./cloneDeep-91467704.js","./index-9ae6381b.js","./index-61adb48a.js","./pick-dba65392.js","./useGetProjectSummaryFields-0ab32aca.js","./SelectEsModelInput-d580a9f7.js","./Link-c687dc07.js","./useIncludeFieldNames-35a180a9.js","./Save-b67fa0ac.js","./index-147ad7aa.js","./Add-be7f5660.js","./Stop-d43309a7.js","./VewJobDetails.story-c6ae2e88.js","./index-72884e22.js","./index-356e4a49.js","./stories-1f769a10.js","./index-63a3e378.js","./index.esm-bf21a293.js","./index-ce960f89.js","./index-f70ce446.js","./zod-575fe4a8.js","./userGroups-edff3f7b.js","./ProjectLink-987015ba.js","./SyncEagleDevTool-4c34bdb8.js","./searchUsers-04324aeb.js","./find-8750f979.js","./index-18188c67.js","./useFetchMore-be228481.js","./useTagSearch-f4fcfbe9.js","./Skeleton-cd6f071e.js","./ExpandMore-79a3c159.js","./uniqBy-baac1626.js","./RemoveCircle-617bdac2.js","./index-b769406f.js","./DragIndicator-582939ba.js","./TableRow-00aadd87.js","./TableHead-dd1583ce.js","./capitalize-c31f38e2.js","./isString-2f2f79c0.js","./Person-5be09a1e.js","./times-069ea398.js","./_castFunction-353dfc26.js","./TaskForm-863cdb73.js","./RepeatFields-8275ed19.js","./useBeforeSave-e049f6dd.js","./Alert-fd9a067a.js","./TaskAssignees-858ea3c9.js","./useTaskAssignees-9f1fd5d3.js","./github-91d085b0.js","./SortUpIcon-3aecf5f0.js","./OpportunityLink-b32d0c35.js","./index-9d3afdfc.js","./index-79afbab1.js","./Check-78df5e8e.js","./bundle-053bdffd.js","./MilestoneIcon-61fb6e69.js","./Trash-822e65ce.js","./index-5d349c56.js","./EstimateEditorPopover-b8debf9a.js","./AssigneeEditorPopover-2b4e6473.js","./ToggleButtonGroup-93d9af56.js","./index-0d862032.css","./index-71ed01a9.js","./index-4d31058a.js","./Undo-33c7aa7a.js","./camelCase-4e7e8b23.js","./AuditLogsNoBreadCrumbs-8da9c0ce.js","./ExpenseView-2f5d1473.js","./MenuOptions-0bc3bb51.js","./MultipleSelectFieldInput-d0cee4a2.js","./LocationBeFormBody-c033b2b3.js","./reduce-4f6f1985.js","./VewJobDetails-6c7b73a1.css","./ExpandLess-3302d2ff.js","./index-66552ec6.js"],import.meta.url)),Jt=n.lazy(()=>k(()=>import("./papaparse.min-b66e70e7.js").then(t=>t.f$),["./papaparse.min-b66e70e7.js","./index-f1f749bf.js","./_commonjsHelpers-042e6b4d.js","./TransitionGroupContext-9d36972e.js","./assertThisInitialized-ad1db8e7.js","./_arrayIncludes-2cfb33ae.js","./_baseForOwn-9b89c4b6.js","./index-bcfaa842.js","./index-96c5f47c.js","./isNativeReflectConstruct-05c29d01.js","./Button-352c3435.js","./isPlainObject-07477f89.js","./debounce-213cd46f.js","./iframe-ed7f5a3f.js","./index-4d501b15.js","./papaparse-cdbe7e6d.css"],import.meta.url));function Kt(){const{userId:t}=U(),a=_e({userId:t});return e.jsx(n.Suspense,{fallback:e.jsx(st,{}),children:e.jsx(Jt,{path:`member/${t}`,sourceOpts:[a]})})}function Vr(){var y;const{userId:t}=U(),a=F.useRef(),[r,{refetch:s}]=Wt(t),o=kt(t&&`member/${t}`),l=oe("CUSTOM_TEAM_MEMBERS_TABS").value,f=(y=l==null?void 0:l.certification)!=null&&y.show?[{label:"Certifications",route:"/member/:userId/certifications",component:Kt,items:o==null?void 0:o.count}]:[],b=n.useMemo(()=>[...f],[o]);F.useEffect(()=>{a.current||(a.current=r)},[r]);const u=oe("TEAM_MEMBER_FORM_V2").value?ke:Me,{globalState:{authUser:j}}=tt(),p=ht.isStaffRole(j),d=n.useMemo(()=>p?[]:[{label:"",link:"/"},{label:"Team Members",link:"/member"},{label:(r==null?void 0:r.group)||"..",link:null},{label:(r==null?void 0:r.fullname)||"..",link:null}],[p]);ft({paths:d},[r]);const{result:i,request:h}=it({api:Bt,params:{userId:t,status:"OPEN"}}),v=n.useCallback(async()=>{h()},[h]);nt(()=>{v()});const L=n.useMemo(()=>ot(new Date,{weekStartsOn:1}),[]),T=`${V(Date.parse(`${L}`),"yyyy-MM-dd")}T00:00:00.000Z`,w=n.useMemo(()=>({startDate:fe(new Date),endDate:be(new Date)}),[]),z=`${V(Date.parse(`${w.startDate}`),"yyyy-MM-dd")}T00:00:00.000Z`,x=`${V(Date.parse(`${w.endDate}`),"yyyy-MM-dd")}T00:00:00.000Z`,m=de(C("allocation",{bool:{must:[{range:{date:{gte:T}}},{term:{"memberId.keyword":t}}]}}),C("activity",{bool:{must_not:[{term:{"status.keyword":"done"}}],must:[{term:{"activityTeamMemberId.keyword":t}}]}}),C("taskassignment","userId",t),C("interval",{bool:{must:[{range:{startedAt:{gte:z,lte:x}}},{term:{"userId.keyword":t}}]}}),C("note","noteTeamMemberId",t),C("skill","skillTeamMemberId",t),C("userlocation","userId",t));return console.log(">>member/Member::","esData",m),n.useMemo(()=>e.jsx(I,{sx:{"& > .MuiBox-root > .MuiPaper-root":{display:p?"none":"inherit"}},children:e.jsx(Te,{form:A=>e.jsx(u,{id:t,initialValues:r,onDelete:()=>A.history.push("/member"),onLoad:M=>(!M||M.archived)&&A.hideTabs(),onSubmit:M=>{console.log("AFTER SAVE",{data:M}),s()}}),defaultRoute:`/member/${t}/timesheet`,summary:()=>e.jsx(Mt,{}),tabs:p?[]:[{label:"Timesheet",route:"/member/:userId/timesheet",component:()=>e.jsx(Gt,{hideTitle:!0,userOnly:t})},{label:"Schedule",route:"/member/:userId/schedule",component:Qt,items:S(m,"result[0].hits.total")},{label:"Activities",route:"/member/:userId/activities",component:()=>e.jsx(Ht,{activeOnly:t}),items:S(m,"result[1].hits.total")},{label:"Tasks",route:"/member/:userId/tasks",component:()=>e.jsx(Nt,{defaultStatus:"OPEN"}),items:i},{label:"Intervals",route:"/member/:userId/intervals",component:zt,items:S(m,"result[3].hits.total")},{label:"KPI",route:"/member/:userId/kpi",component:Vt,items:Object.keys(S(r,"kpi.items",{})).length},{label:"Notes",route:"/member/:userId/notes",component:qt,items:S(m,"result[4].hits.total")},{label:"Availabilities",route:"/member/:userId/availabilities",component:wt},{label:"Skills",route:"/member/:userId/skills",component:Rt,items:S(m,"result[5].hits.total")},{label:"Locations",route:"/member/:userId/locations",component:()=>e.jsx(Pt,{userId:t}),items:S(m,"result[6].hits.total")},{label:"Audit Logs",route:"/member/:userId/auditlogs",component:()=>e.jsx(xt,{model:"User",modelId:t})},...b]})}),[t,m,o])}export{Vr as default};
