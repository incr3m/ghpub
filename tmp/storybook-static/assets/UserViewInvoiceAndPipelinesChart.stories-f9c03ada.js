import{j}from"./TransitionGroupContext-9d36972e.js";import{R as Wt}from"./index-f1f749bf.js";import{G as q,w as Rt,m as st,B as jt,b as F,D as H,e as E,F as wt,H as qt,I as R,J as pt,K as tt,M as Ht,i as bt,N as mt,O as Dt,Q as Pt,U as Qt,V as vt,g as ct,h as Z,W as Zt,c as ot,R as Kt,o as $t,A as te,T as _t,p as It,E as ee}from"./EmptyFiltersWarning-efcfc65c.js";import{aP as ie,bd as se,cp as ne,a$ as ae,b0 as re,b2 as et,b3 as Vt,cq as oe,b1 as le,v as ue,w as he,be as kt,a2 as ce,P as de,B as Tt,x as pe,T as Mt,bf as ge,bg as fe,bh as me}from"./papaparse.min-b66e70e7.js";import"./_baseForOwn-9b89c4b6.js";import{F as ve,H as _e,i as it,f as lt,d as yt,e as At,l as L}from"./index-bcfaa842.js";import"./index-96c5f47c.js";import{t as be}from"./times-069ea398.js";import{R as Ft,e as ye,V as xt,c as Lt,X as xe,b as we,a as De,A as Pe,B as St,L as Ie}from"./AxisRendererY-0d50d85b.js";import{c as N,p as Nt}from"./constant-1abab5a9.js";import"./assertThisInitialized-ad1db8e7.js";import"./_commonjsHelpers-042e6b4d.js";import"./_arrayIncludes-2cfb33ae.js";import"./Button-352c3435.js";import"./isPlainObject-07477f89.js";import"./debounce-213cd46f.js";import"./iframe-ed7f5a3f.js";import"../sb-preview/runtime.js";import"./index-4d501b15.js";import"./isNativeReflectConstruct-05c29d01.js";import"./_castFunction-353dfc26.js";class ut extends q{_afterNew(){super._afterNew(),this._display.isMeasured=!0,this.setPrivateRaw("trustBounds",!0)}_beforeChanged(){super._beforeChanged(),this.isDirty("radius")&&(this._clear=!0)}_changed(){super._changed(),this._clear&&this._display.drawCircle(0,0,this.get("radius",10))}}Object.defineProperty(ut,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Circle"});Object.defineProperty(ut,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:q.classNames.concat([ut.className])});class gt extends Rt{constructor(){super(...arguments),Object.defineProperty(this,"thumb",{enumerable:!0,configurable:!0,writable:!0,value:this._makeThumb()}),Object.defineProperty(this,"startGrip",{enumerable:!0,configurable:!0,writable:!0,value:this._makeButton()}),Object.defineProperty(this,"endGrip",{enumerable:!0,configurable:!0,writable:!0,value:this._makeButton()}),Object.defineProperty(this,"_thumbBusy",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_startDown",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_endDown",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_thumbDown",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_gripDown",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_addOrientationClass(){this._settings.themeTags=st(this._settings.themeTags,["scrollbar",this._settings.orientation]),this._settings.background||(this._settings.background=Ft.new(this._root,{themeTags:st(this._settings.themeTags,["main","background"])}))}_makeButton(){return this.children.push(ye.new(this._root,{themeTags:["resize","button",this.get("orientation")],icon:q.new(this._root,{themeTags:["icon"]})}))}_makeThumb(){return this.children.push(Ft.new(this._root,{themeTags:["thumb",this.get("orientation")]}))}_handleAnimation(t){t&&this._disposers.push(t.events.on("stopped",()=>{this.setPrivateRaw("isBusy",!1),this._thumbBusy=!1}))}_afterNew(){this._addOrientationClass(),super._afterNew();const t=this.startGrip,e=this.endGrip,i=this.thumb,a=this.get("background");a&&this._disposers.push(a.events.on("click",n=>{this.setPrivateRaw("isBusy",!0);const s=this._display.toLocal(n.point),r=this.width(),o=this.height(),h=this.get("orientation");let l;h=="vertical"?l=(s.y-i.height()/2)/o:l=(s.x-i.width()/2)/r;let u,p;h=="vertical"?(u=l*o,p="y"):(u=l*r,p="x");const c=this.get("animationDuration",0);c>0?(this._thumbBusy=!0,this._handleAnimation(this.thumb.animate({key:p,to:u,duration:c,easing:this.get("animationEasing")}))):(this.thumb.set(p,u),this._root.events.once("frameended",()=>{this.setPrivateRaw("isBusy",!1)}))})),this._disposers.push(i.events.on("dblclick",n=>{if(!jt(n.originalEvent,this))return;const s=this.get("animationDuration",0),r=this.get("animationEasing");this.animate({key:"start",to:0,duration:s,easing:r}),this.animate({key:"end",to:1,duration:s,easing:r})})),this._disposers.push(t.events.on("pointerdown",()=>{this.setPrivateRaw("isBusy",!0),this._startDown=!0,this._gripDown="start"})),this._disposers.push(e.events.on("pointerdown",()=>{this.setPrivateRaw("isBusy",!0),this._endDown=!0,this._gripDown="end"})),this._disposers.push(i.events.on("pointerdown",()=>{this.setPrivateRaw("isBusy",!0),this._thumbDown=!0,this._gripDown=void 0})),this._disposers.push(t.events.on("globalpointerup",()=>{this._startDown&&this.setPrivateRaw("isBusy",!1),this._startDown=!1})),this._disposers.push(e.events.on("globalpointerup",()=>{this._endDown&&this.setPrivateRaw("isBusy",!1),this._endDown=!1})),this._disposers.push(i.events.on("globalpointerup",()=>{this._thumbDown&&this.setPrivateRaw("isBusy",!1),this._thumbDown=!1})),this._disposers.push(t.on("x",()=>{this._updateThumb()})),this._disposers.push(e.on("x",()=>{this._updateThumb()})),this._disposers.push(t.on("y",()=>{this._updateThumb()})),this._disposers.push(e.on("y",()=>{this._updateThumb()})),this._disposers.push(i.events.on("positionchanged",()=>{this._updateGripsByThumb()})),this.get("orientation")=="vertical"?(t.set("x",0),e.set("x",0),this._disposers.push(i.adapters.add("y",n=>Math.max(Math.min(Number(n),this.height()-i.height()),0))),this._disposers.push(i.adapters.add("x",n=>this.width()/2)),this._disposers.push(t.adapters.add("x",n=>this.width()/2)),this._disposers.push(e.adapters.add("x",n=>this.width()/2)),this._disposers.push(t.adapters.add("y",n=>Math.max(Math.min(Number(n),this.height()),0))),this._disposers.push(e.adapters.add("y",n=>Math.max(Math.min(Number(n),this.height()),0)))):(t.set("y",0),e.set("y",0),this._disposers.push(i.adapters.add("x",n=>Math.max(Math.min(Number(n),this.width()-i.width()),0))),this._disposers.push(i.adapters.add("y",n=>this.height()/2)),this._disposers.push(t.adapters.add("y",n=>this.height()/2)),this._disposers.push(e.adapters.add("y",n=>this.height()/2)),this._disposers.push(t.adapters.add("x",n=>Math.max(Math.min(Number(n),this.width()),0))),this._disposers.push(e.adapters.add("x",n=>Math.max(Math.min(Number(n),this.width()),0))))}_updateChildren(){super._updateChildren(),(this.isDirty("end")||this.isDirty("start")||this._sizeDirty)&&this.updateGrips()}_changed(){if(super._changed(),this.isDirty("start")||this.isDirty("end")){const t="rangechanged";this.events.isEnabled(t)&&this.events.dispatch(t,{type:t,target:this,start:this.get("start",0),end:this.get("end",1),grip:this._gripDown})}}updateGrips(){const t=this.startGrip,e=this.endGrip,i=this.get("orientation"),a=this.height(),n=this.width();i=="vertical"?(t.set("y",a*this.get("start",0)),e.set("y",a*this.get("end",1))):(t.set("x",n*this.get("start",0)),e.set("x",n*this.get("end",1)));const s=this.getPrivate("positionTextFunction"),r=Math.round(this.get("start",0)*100),o=Math.round(this.get("end",0)*100);let h,l;s?(h=s.call(this,this.get("start",0)),l=s.call(this,this.get("end",0))):(h=r+"%",l=o+"%"),t.set("ariaLabel",this._t("From %1",void 0,h)),t.set("ariaValueNow",""+r),t.set("ariaValueText",r+"%"),t.set("ariaValueMin","0"),t.set("ariaValueMax","100"),e.set("ariaLabel",this._t("To %1",void 0,l)),e.set("ariaValueNow",""+o),e.set("ariaValueText",o+"%"),e.set("ariaValueMin","0"),e.set("ariaValueMax","100")}_updateThumb(){const t=this.thumb,e=this.startGrip,i=this.endGrip,a=this.height(),n=this.width();let s=e.x(),r=i.x(),o=e.y(),h=i.y(),l=0,u=1;this.get("orientation")=="vertical"?F(o)&&F(h)&&(!this._thumbBusy&&!t.isDragging()&&(t.set("height",h-o),t.set("y",o)),l=o/a,u=h/a):F(s)&&F(r)&&(!this._thumbBusy&&!t.isDragging()&&(t.set("width",r-s),t.set("x",s)),l=s/n,u=r/n),this.getPrivate("isBusy")&&(this.get("start")!=l||this.get("end")!=u)&&(this.set("start",l),this.set("end",u));const p=this.getPrivate("positionTextFunction"),c=Math.round(this.get("start",0)*100),v=Math.round(this.get("end",0)*100);let x,g;p?(x=p.call(this,this.get("start",0)),g=p.call(this,this.get("end",0))):(x=c+"%",g=v+"%"),t.set("ariaLabel",this._t("From %1 to %2",void 0,x,g)),t.set("ariaValueNow",""+c),t.set("ariaValueText",c+"%")}_updateGripsByThumb(){const t=this.thumb,e=this.startGrip,i=this.endGrip;if(this.get("orientation")=="vertical"){const a=t.height();e.set("y",t.y()),i.set("y",t.y()+a)}else{const a=t.width();e.set("x",t.x()),i.set("x",t.x()+a)}}}Object.defineProperty(gt,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Scrollbar"});Object.defineProperty(gt,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Rt.classNames.concat([gt.className])});function Bt(m){this._context=m}Bt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(m,t){switch(m=+m,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(m,t):this._context.moveTo(m,t);break;case 1:this._point=2;default:this._context.lineTo(m,t);break}}};function Yt(m){return new Bt(m)}function Ut(m){return m[0]}function Xt(m){return m[1]}function zt(){var m=Ut,t=Xt,e=N(!0),i=null,a=Yt,n=null;function s(r){var o,h=r.length,l,u=!1,p;for(i==null&&(n=a(p=Nt())),o=0;o<=h;++o)!(o<h&&e(l=r[o],o,r))===u&&((u=!u)?n.lineStart():n.lineEnd()),u&&n.point(+m(l,o,r),+t(l,o,r));if(p)return n=null,p+""||null}return s.x=function(r){return arguments.length?(m=typeof r=="function"?r:N(+r),s):m},s.y=function(r){return arguments.length?(t=typeof r=="function"?r:N(+r),s):t},s.defined=function(r){return arguments.length?(e=typeof r=="function"?r:N(!!r),s):e},s.curve=function(r){return arguments.length?(a=r,i!=null&&(n=a(i)),s):a},s.context=function(r){return arguments.length?(r==null?i=n=null:n=a(i=r),s):i},s}function ke(){var m=Ut,t=null,e=N(0),i=Xt,a=N(!0),n=null,s=Yt,r=null;function o(l){var u,p,c,v=l.length,x,g=!1,D,P=new Array(v),S=new Array(v);for(n==null&&(r=s(D=Nt())),u=0;u<=v;++u){if(!(u<v&&a(x=l[u],u,l))===g)if(g=!g)p=u,r.areaStart(),r.lineStart();else{for(r.lineEnd(),r.lineStart(),c=u-1;c>=p;--c)r.point(P[c],S[c]);r.lineEnd(),r.areaEnd()}g&&(P[u]=+m(x,u,l),S[u]=+e(x,u,l),r.point(t?+t(x,u,l):P[u],i?+i(x,u,l):S[u]))}if(D)return r=null,D+""||null}function h(){return zt().defined(a).curve(s).context(n)}return o.x=function(l){return arguments.length?(m=typeof l=="function"?l:N(+l),t=null,o):m},o.x0=function(l){return arguments.length?(m=typeof l=="function"?l:N(+l),o):m},o.x1=function(l){return arguments.length?(t=l==null?null:typeof l=="function"?l:N(+l),o):t},o.y=function(l){return arguments.length?(e=typeof l=="function"?l:N(+l),i=null,o):e},o.y0=function(l){return arguments.length?(e=typeof l=="function"?l:N(+l),o):e},o.y1=function(l){return arguments.length?(i=l==null?null:typeof l=="function"?l:N(+l),o):i},o.lineX0=o.lineY0=function(){return h().x(m).y(e)},o.lineY1=function(){return h().x(m).y(i)},o.lineX1=function(){return h().x(t).y(e)},o.defined=function(l){return arguments.length?(a=typeof l=="function"?l:N(!!l),o):a},o.curve=function(l){return arguments.length?(s=l,n!=null&&(r=s(n)),o):s},o.context=function(l){return arguments.length?(l==null?n=r=null:r=s(n=l),o):n},o}class ft extends xt{constructor(){super(...arguments),Object.defineProperty(this,"_dataGrouped",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_seriesDataGrouped",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_groupingCalculated",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_intervalDuration",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_baseDuration",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_intervalMax",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_intervalMin",{enumerable:!0,configurable:!0,writable:!0,value:{}})}_afterNew(){this._settings.themeTags=st(this._settings.themeTags,["axis"]),super._afterNew(),this._setBaseInterval(this.get("baseInterval")),this.on("baseInterval",()=>{this._setBaseInterval(this.get("baseInterval"))})}_setBaseInterval(t){this.setPrivateRaw("baseInterval",t),this._baseDuration=H(t)}_fixZoomFactor(){const t=this.get("maxZoomFactor");t!=null&&t!=1/0?this.setPrivateRaw("maxZoomFactor",t):this.setPrivateRaw("maxZoomFactor",Math.round((this.getPrivate("max",0)-this.getPrivate("min",0))/this.baseMainDuration()))}_groupData(){const t=this.getPrivate("min"),e=this.getPrivate("max");if(F(t)&&F(e)){this._fixZoomFactor();const i=this.getPrivate("groupInterval");if(i?this._setBaseInterval(i):this._setBaseInterval(this.get("baseInterval")),this.isDirty("groupInterval")){let a=this.get("groupInterval");a&&(this.setRaw("groupIntervals",[a]),this._handleRangeChange())}if(this.isDirty("groupData")&&!this._dataGrouped){if(this.get("groupData"))E(this.series,a=>{this._groupSeriesData(a)}),this._handleRangeChange();else{let a=this.get("baseInterval"),n=a.timeUnit+a.count;E(this.series,s=>{s.setDataSet(n),s.resetGrouping()}),this._setBaseInterval(a),this.setPrivateRaw("groupInterval",void 0),this.markDirtyExtremes()}this._dataGrouped=!0}}}_groupSeriesData(t){if(this.get("groupData")&&!t.get("groupDataDisabled")){this._dataGrouped=!0,this._seriesDataGrouped=!0;let e=[],i=this.baseMainDuration(),a=this.get("groupIntervals");E(a,c=>{H(c)>i&&e.push(c)}),t._dataSets={};const n=this.getPrivate("name")+this.get("renderer").getPrivate("letter");let s;const r=t.get("baseAxis");t.get("xAxis")===r?s=t._valueYFields:t.get("yAxis")===r&&(s=t._valueXFields);let o=t._mainDataItems,h=this.get("baseInterval"),l=h.timeUnit+h.count;t._dataSets[l]=o;const u=t.get("groupDataCallback");let p=t.get("groupDataWithOriginals",!1);u&&(p=!0),E(e,c=>{let v=-1/0,x=c.timeUnit+c.count;t._dataSets[x]=[];let g,D={},P={},S={},B={};E(s,y=>{D[y]=0,P[y]=0,S[y]=t.get(y+"Grouped"),B[y]=y+"Working"});let V=tt(c.timeUnit),U=o[0],d;U&&(d=o[0].get(n));let f;E(o,y=>{let O=y.get(n),I=R(O,c.timeUnit,c.count,this._root,d),Y;v<I-V/24?(Y=Pt(y.dataContext),g=new pt(t,Y,t._makeDataItem(Y)),g.setRaw(n,I),t._dataSets[x].push(g),E(s,_=>{let k=y.get(_);F(k)?(g.setRaw(_,k),g.setRaw(B[_],k),P[_]=1,D[_]=k):(D[_]=0,P[_]=0)}),p&&g.set("originals",[y]),u&&f&&u(f,c),f=g):(E(s,_=>{let k=S[_],T=y.get(_);if(T!=null){let C=g.get(_);switch(k){case"close":g.setRaw(_,T);break;case"sum":g.setRaw(_,C+T);break;case"open":break;case"low":T<C&&g.setRaw(_,T);break;case"high":T>C&&g.setRaw(_,T);break;case"average":P[_]++,D[_]+=T;let Q=D[_]/P[_];g.setRaw(_,Q);break;case"extreme":Math.abs(T)>Math.abs(C)&&g.setRaw(_,T);break}g.setRaw(B[_],g.get(_));let X=Pt(y.dataContext);X[n]=I,g.dataContext=X}}),p&&g.get("originals").push(y)),v=I}),u&&f&&u(f,c)}),t._dataSetId&&t.setDataSet(t._dataSetId),this.markDirtySize()}}_clearDirty(){super._clearDirty(),this._groupingCalculated=!1,this._dataGrouped=!1}getGroupInterval(t){let e=this.get("baseInterval"),i=wt(0,t,this.get("groupCount",1/0),this.get("groupIntervals"));return H(i)<H(e)&&(i=Object.assign({},e)),i}getIntervalMax(t){return this._intervalMax[t.timeUnit+t.count]}getIntervalMin(t){return this._intervalMin[t.timeUnit+t.count]}_handleRangeChange(){super._handleRangeChange();let t=Math.round(this.getPrivate("selectionMin")),e=Math.round(this.getPrivate("selectionMax"));if(F(t)&&F(e)){if(this.get("endLocation")==0&&(e+=1),this.get("groupData")&&!this._groupingCalculated){this._groupingCalculated=!0;let i=this.get("groupInterval"),a=this.getPrivate("groupInterval"),n=e-t+(this.get("startLocation",0)+(1-this.get("endLocation",1))*this.baseDuration());if(a){let s=H(a);n=Math.ceil(n/s)*s}if(i||(i=this.getGroupInterval(n)),i&&(!a||a.timeUnit!==i.timeUnit||a.count!==i.count||this._seriesDataGrouped)){this._seriesDataGrouped=!1,this.setPrivateRaw("groupInterval",i),this._setBaseInterval(i);let s=i.timeUnit+i.count;E(this.series,r=>{r.get("baseAxis")===this&&r.setDataSet(s)}),this.markDirtyExtremes(),this._root.events.once("frameended",()=>{this._root.events.once("frameended",()=>{const r="groupintervalchanged";this.events.isEnabled(r)&&this.events.dispatch(r,{type:r,target:this})})})}}E(this.series,i=>{if(i.get("baseAxis")===this){let a=this.getPrivate("name")+this.get("renderer").getPrivate("letter"),s=Qt(i.dataItems,x=>vt(x.get(a),t)).index;s>0&&(s-=1),e+=this.baseDuration()*(1-this.get("endLocation",1));let o=Dt(i.dataItems,x=>vt(x.get(a),e)).index,h=o;h>1&&h--;const l=i.dataItems[s],u=i.dataItems[h];let p,c;l&&(c=l.get(a)),u&&(p=u.get(a));let v=!1;p!=null&&c!=null&&(p<t||c>e)&&(v=!0),i.setPrivate("outOfSelection",v),i.setPrivate("startIndex",s),i.setPrivate("endIndex",o)}})}}_adjustMinMax(t,e,i,a){return{min:t,max:e,step:(e-t)/i}}intervalDuration(){return this._intervalDuration}_saveMinMax(t,e){let i=this.getPrivate("groupInterval");i||(i=this.get("baseInterval"));let a=i.timeUnit+i.count;this._intervalMin[a]=t,this._intervalMax[a]=e}_getM(t){return t=="month"||t=="year"||t=="day"?1.05:1.01}_getMinorInterval(t){var e;let i,a=t.count,n=t.timeUnit;return a>1&&(a==10||a==15?a=5:a==12?a=2:a==6?a=1:a==30?a=10:a<10&&(a=1),i={timeUnit:n,count:a}),n=="week"&&((e=this.getPrivate("baseInterval"))===null||e===void 0?void 0:e.timeUnit)!="week"&&(i={timeUnit:"day",count:1}),i}_prepareAxisItems(){const t=this.getPrivate("min"),e=this.getPrivate("max");if(F(t)&&F(e)){const i=this._root,a=Math.round(this.getPrivate("selectionMin")),n=Math.round(this.getPrivate("selectionMax")),s=this.get("renderer"),r=this.getPrivate("baseInterval");let o=a,h=0;const l=this.get("gridIntervals");let u=wt(0,n-a,s.gridCount(),l);H(u)<this.baseDuration()&&(u=Object.assign({},r));const p=H(u);this._intervalDuration=p;const c=qt(u.timeUnit),v=i.utc,x=i.timezone;o=R(a-p,u.timeUnit,u.count,i,t);let g=o-p,D;const P=this.get("dateFormats");this.setPrivateRaw("gridInterval",u);const S=s.get("minorLabelsEnabled"),B=s.get("minorGridEnabled",S);let V,U=0;B&&(V=this._getMinorInterval(u),U=H(V));let d=0;for(;o<n+p;){let f;this.dataItems.length<h+1?(f=new pt(this,void 0,{}),this._dataItems.push(f),this.processDataItem(f)):f=this.dataItems[h],this._createAssets(f,[]),this._toggleDataItem(f,!0),f.setRaw("value",o),f.setRaw("labelEndValue",void 0);let y=o+tt(u.timeUnit,u.count*this._getM(u.timeUnit));y=R(y,u.timeUnit,1,i),f.setRaw("endValue",y);let O=new Date(o);D=P[u.timeUnit],c&&this.get("markUnitChange")&&F(g)&&u.timeUnit!="year"&&Ht(o,g,c,v,x)&&(D=this.get("periodChangeDateFormats")[u.timeUnit]);const I=f.get("label");I&&I.set("text",i.dateFormatter.format(O,D));let Y=u.count;if(u.timeUnit=="week"&&f.setRaw("labelEndValue",o),B){Y=1;let _=u.timeUnit;_=="week"&&(_="day");let k=o+tt(_,this._getM(_));k=R(k,_,1,i),f.setRaw("labelEndValue",k)}if(this._prepareDataItem(f,Y),g=o,o=y,V){const _=V.timeUnit,k=V.count,T=this._getM(_);let C=R(g+U*T,_,k,i,g),X,Q=this.get("minorDateFormats",this.get("dateFormats"));for(;C<o-.01*U;){let w;this.minorDataItems.length<d+1?(w=new pt(this,void 0,{}),this.minorDataItems.push(w),this.processDataItem(w)):w=this.minorDataItems[d],this._createAssets(w,["minor"],!0),this._toggleDataItem(w,!0),w.setRaw("value",C);let z=C+tt(_,k*T);z=R(z,_,1,i),w.setRaw("endValue",z);let K=new Date(C);D=Q[_];const M=w.get("label");if(M&&(S?M.set("text",i.dateFormatter.format(K,D)):M.setPrivate("visible",!1)),this._prepareDataItem(w,1),C==X)break;X=C,C=z,d++}}if(o==g)break;h++}for(let f=h;f<this.dataItems.length;f++)this._toggleDataItem(this.dataItems[f],!1);for(let f=d;f<this.minorDataItems.length;f++)this._toggleDataItem(this.minorDataItems[f],!1);E(this.series,f=>{f.inited&&f._markDirtyAxes()})}this._updateGhost()}_updateFinals(t,e){this.setPrivateRaw("selectionMinFinal",this.positionToValue(t)),this.setPrivateRaw("selectionMaxFinal",this.positionToValue(e))}_getDelta(){this._deltaMinMax=this.baseDuration()/2}_fixMin(t){const e=this.getPrivate("baseInterval"),i=e.timeUnit;let a=R(t,i,e.count,this._root),n=a+tt(i,e.count*this._getM(i));return n=R(n,i,1,this._root),a+(n-a)*this.get("startLocation",0)}_fixMax(t){const e=this.getPrivate("baseInterval"),i=e.timeUnit;let a=R(t,i,e.count,this._root),n=a+tt(i,e.count*this._getM(i));return n=R(n,i,1,this._root),a+(n-a)*this.get("endLocation",1)}_updateDates(t,e){}baseDuration(){return this._baseDuration}baseMainDuration(){return H(this.get("baseInterval"))}processSeriesDataItem(t,e){const i=this.getPrivate("baseInterval");t.open||(t.open={}),t.close||(t.close={}),E(e,a=>{let n=t.get(a);if(F(n)){let s=t.open[a],r=t.close[a];if(!(n>=s&&n<=r)){const o=i.timeUnit,h=i.count;s=R(n,o,h,this._root),r=s+tt(o,h*this._getM(o)),r=R(r,o,1,this._root),t.open[a]=s,t.close[a]=r}this._updateDates(s,t.component)}})}getDataItemPositionX(t,e,i,a){let n,s;t.open&&t.close?(n=t.open[e],s=t.close[e]):(n=t.get(e),s=n);let r=n+(s-n)*i;return r=this._baseValue+(r-this._baseValue)*a,this.valueToPosition(r)}getDataItemCoordinateX(t,e,i,a){return this._settings.renderer.positionToCoordinate(this.getDataItemPositionX(t,e,i,a))}getDataItemPositionY(t,e,i,a){let n,s;t.open&&t.close?(n=t.open[e],s=t.close[e]):(n=t.get(e),s=n);let r=n+(s-n)*i;return r=this._baseValue+(r-this._baseValue)*a,this.valueToPosition(r)}getDataItemCoordinateY(t,e,i,a){return this._settings.renderer.positionToCoordinate(this.getDataItemPositionY(t,e,i,a))}roundAxisPosition(t,e){let i=this.positionToValue(t);i=i-(e-.5)*this.baseDuration();let a=this.getPrivate("baseInterval");if(!bt(i)){const n=this._root.locale.firstDayOfWeek,s=a.timeUnit,r=this._root.utc,o=this._root.timezone,h=a.count;i=R(i,s,h,this._root,this.getPrivate("min",0));let l=mt(a,new Date(i),n,r,o);return o&&(i=R(i+this.baseDuration()*.05,s,h,this._root,this.getPrivate("min",0)),l=mt(a,new Date(i+l*e),n,r,o)),this.valueToPosition(i+l*e)}return NaN}getTooltipText(t,e){if(this.getPrivate("min")!=null){let i=this.get("tooltipDateFormats")[this.getPrivate("baseInterval").timeUnit],a=this.positionToValue(t);if(F(a)){let n=new Date(a),s=this.getPrivate("baseInterval"),r=mt(s,n,this._root.locale.firstDayOfWeek,this._root.utc,this._root.timezone);return e!==!1&&(n=new Date(a+this.get("tooltipIntervalOffset",-this.get("tooltipLocation",.5))*r)),this._root.dateFormatter.format(n,this.get("tooltipDateFormat",i))}}return""}getSeriesItem(t,e,i,a){let n=this.getPrivate("name")+this.get("renderer").getPrivate("letter"),s=this.positionToValue(e);i==null&&(i=.5),s=s-(i-.5)*this.baseDuration();const r=Dt(t.dataItems,o=>{let h=0;return o.open&&(h=o.open[n]),vt(h,s)});if(a||t.get("snapTooltip")){let o=t.dataItems[r.index-1],h=t.dataItems[r.index];if(o&&h&&o.open&&h.close){let l=o.open[n],u=h.close[n];if(Math.abs(s-l)>Math.abs(s-u))return h}if(o)return o;if(h)return h}else{const o=t.dataItems[r.index-1];if(o&&o.open&&o.close){let h=o.open[n],l=o.close[n];if(s>=h&&s<=l)return o}}}shouldGap(t,e,i,a){const n=t.get(a);return e.get(a)-n>this.baseDuration()*i}zoomToDates(t,e,i){this.zoomToValues(t.getTime(),e.getTime(),i)}positionToDate(t){return new Date(this.positionToValue(t))}dateToPosition(t){return this.valueToPosition(t.getTime())}getCellWidthPosition(){let t=this.getPrivate("selectionMax",this.getPrivate("max")),e=this.getPrivate("selectionMin",this.getPrivate("min"));return F(t)&&F(e)?this._intervalDuration/(t-e):.05}}Object.defineProperty(ft,"className",{enumerable:!0,configurable:!0,writable:!0,value:"DateAxis"});Object.defineProperty(ft,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:xt.classNames.concat([ft.className])});class ht extends Lt{constructor(){super(...arguments),Object.defineProperty(this,"_endIndex",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_strokeGenerator",{enumerable:!0,configurable:!0,writable:!0,value:zt()}),Object.defineProperty(this,"_fillGenerator",{enumerable:!0,configurable:!0,writable:!0,value:ke()}),Object.defineProperty(this,"_legendStroke",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_legendFill",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"strokes",{enumerable:!0,configurable:!0,writable:!0,value:new ct(Z.new({}),()=>q._new(this._root,{themeTags:st(this.strokes.template.get("themeTags",[]),["line","series","stroke"])},[this.strokes.template]))}),Object.defineProperty(this,"fills",{enumerable:!0,configurable:!0,writable:!0,value:new ct(Z.new({}),()=>q._new(this._root,{themeTags:st(this.strokes.template.get("themeTags",[]),["line","series","fill"])},[this.fills.template]))}),Object.defineProperty(this,"_fillTemplate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_strokeTemplate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_previousPoint",{enumerable:!0,configurable:!0,writable:!0,value:[0,0,0,0]}),Object.defineProperty(this,"_dindex",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_sindex",{enumerable:!0,configurable:!0,writable:!0,value:0})}_afterNew(){this._fillGenerator.y0(function(t){return t[3]}),this._fillGenerator.x0(function(t){return t[2]}),this._fillGenerator.y1(function(t){return t[1]}),this._fillGenerator.x1(function(t){return t[0]}),super._afterNew()}makeStroke(t){const e=this.mainContainer.children.push(t.make());return t.push(e),e}makeFill(t){const e=this.mainContainer.children.push(t.make());return t.push(e),e}_updateChildren(){this._strokeTemplate=void 0,this._fillTemplate=void 0;let t=this.get("xAxis"),e=this.get("yAxis");if(this.isDirty("stroke")){const i=this.get("stroke");this.strokes.template.set("stroke",i);const a=this._legendStroke;a&&a.states.lookup("default").set("stroke",i)}if(this.isDirty("fill")){const i=this.get("fill");this.fills.template.set("fill",i);const a=this._legendFill;a&&a.states.lookup("default").set("fill",i)}if(this.isDirty("curveFactory")){const i=this.get("curveFactory");i&&(this._strokeGenerator.curve(i),this._fillGenerator.curve(i))}if(t.inited&&e.inited){if(this._axesDirty||this._valuesDirty||this._stackDirty||this.isDirty("vcx")||this.isDirty("vcy")||this._sizeDirty||this.isDirty("connect")||this.isDirty("curveFactory")){this.fills.each(l=>{l.setPrivate("visible",!1)}),this.strokes.each(l=>{l.setPrivate("visible",!1)}),this.axisRanges.each(l=>{let u=l.fills;u&&u.each(c=>{c.setPrivate("visible",!1)});let p=l.strokes;p&&p.each(c=>{c.setPrivate("visible",!1)})});let i=this.startIndex(),a=this.strokes.template.get("templateField"),n=this.fills.template.get("templateField"),s=!0,r=!0;a&&(s=!1),n&&(r=!1);for(let l=i-1;l>=0;l--){let u=this.dataItems[l],p=!0,c=u.dataContext;if(a&&c[a]&&(s=!0),n&&c[n]&&(r=!0),E(this._valueFields,v=>{F(u.get(v))||(p=!1)}),p&&s&&r){i=l;break}}let o=this.dataItems.length,h=this.endIndex();if(h<o){h++;for(let l=h;l<o;l++){let u=this.dataItems[l],p=!0;if(E(this._valueFields,c=>{F(u.get(c))||(p=!1)}),p){h=l+1;break}}}if(i>0&&i--,this._endIndex=h,this._clearGraphics(),this._sindex=0,this._dindex=i,this.dataItems.length==1)this._startSegment(0);else for(;this._dindex<h-1;)this._startSegment(this._dindex),this._sindex++}}else this._skipped=!0;super._updateChildren()}_clearGraphics(){this.strokes.clear(),this.fills.clear()}_startSegment(t){let e=this._endIndex,i=e;const a=this.get("autoGapCount"),n=this.get("connect"),s=this.makeFill(this.fills),r=this._fillTemplate,o=this.fills.template;r&&r!=o&&(s.template=r),s.setPrivate("visible",!0);const h=this.makeStroke(this.strokes),l=this._strokeTemplate;l&&l!=this.strokes.template&&(h.template=l),h.setPrivate("visible",!0);let u=this.get("xAxis"),p=this.get("yAxis"),c=this.get("baseAxis"),v=this.get("vcx",1),x=this.get("vcy",1),g=this._xField,D=this._yField,P=this._xOpenField,S=this._yOpenField;const B=this.get("openValueXField"),V=this.get("openValueYField");B||(P=this._xField),V||(S=this._yField);const U=this.get("stacked"),d=u.basePosition(),f=p.basePosition();let y;c===p?y=this._yField:y=this._xField;const O=[];let I=[];O.push(I);const Y=this.strokes.template.get("templateField"),_=this.fills.template.get("templateField");let k=this.get("locationX",.5),T=this.get("locationY",.5),C=this.get("openLocationX",k),X=this.get("openLocationY",T);const Q=this.get("minDistance",0);let w,z=this.fills.template.get("visible");this.axisRanges.length>0&&(z=!0);let K=!1;(U||B||V)&&(K=!0);const M={points:I,segments:O,stacked:U,getOpen:K,basePosX:d,basePosY:f,fillVisible:z,xField:g,yField:D,xOpenField:P,yOpenField:S,vcx:v,vcy:x,baseAxis:c,xAxis:u,yAxis:p,locationX:k,locationY:T,openLocationX:C,openLocationY:X,minDistance:Q};for(w=t;w<i;w++){this._dindex=w;const A=this._dataItems[w];let J=A.get(g),G=A.get(D);if(J==null||G==null?n||(I=[],O.push(I),M.points=I):this._getPoints(A,M),Y){let b=A.dataContext[Y];if(b)if(b instanceof Z||(b=Z.new(b)),this._strokeTemplate=b,w>t){i=w;break}else h.template=b}if(_){let b=A.dataContext[_];if(b)if(b instanceof Z||(b=Z.new(b)),this._fillTemplate=b,w>t){i=w;break}else s.template=b}if(!n){let b=this.dataItems[w+1];b&&c.shouldGap(A,b,a,y)&&(I=[],O.push(I),M.points=I)}}s.setRaw("userData",[t,w]),h.setRaw("userData",[t,w]),w===e&&this._endLine(I,O[0][0]),h&&this._drawStroke(h,O),s&&this._drawFill(s,O),this.axisRanges.each(A=>{const J=A.container,G=A.fills,b=this.makeFill(G);J&&J.children.push(b),b.setPrivate("visible",!0),this._drawFill(b,O);const $=A.strokes,W=this.makeStroke($);J&&J.children.push(W),W.setPrivate("visible",!0),this._drawStroke(W,O),b.setRaw("userData",[t,w]),W.setRaw("userData",[t,w])})}_getPoints(t,e){let i=e.points,a=t.get("locationX",e.locationX),n=t.get("locationY",e.locationY),s=e.xAxis.getDataItemPositionX(t,e.xField,a,e.vcx),r=e.yAxis.getDataItemPositionY(t,e.yField,n,e.vcy);if(this._shouldInclude(s)){const o=this.getPoint(s,r),h=[o.x,o.y];if(o.x+=this._x,o.y+=this._y,t.set("point",o),e.fillVisible){let l=s,u=r;if(e.baseAxis===e.xAxis?u=e.basePosY:e.baseAxis===e.yAxis&&(l=e.basePosX),e.getOpen){let c=t.get(e.xOpenField),v=t.get(e.yOpenField);if(c!=null&&v!=null){let x=t.get("openLocationX",e.openLocationX),g=t.get("openLocationY",e.openLocationY);if(e.stacked){let D=t.get("stackToItemX"),P=t.get("stackToItemY");D?(l=e.xAxis.getDataItemPositionX(D,e.xField,x,D.component.get("vcx")),bt(l)&&(l=e.basePosX)):e.yAxis===e.baseAxis?l=e.basePosX:l=e.xAxis.getDataItemPositionX(t,e.xOpenField,x,e.vcx),P?(u=e.yAxis.getDataItemPositionY(P,e.yField,g,P.component.get("vcy")),bt(u)&&(u=e.basePosY)):e.xAxis===e.baseAxis?u=e.basePosY:u=e.yAxis.getDataItemPositionY(t,e.yOpenField,g,e.vcy)}else l=e.xAxis.getDataItemPositionX(t,e.xOpenField,x,e.vcx),u=e.yAxis.getDataItemPositionY(t,e.yOpenField,g,e.vcy)}}let p=this.getPoint(l,u);h[2]=p.x,h[3]=p.y}if(e.minDistance>0){const l=h[0],u=h[1],p=h[2],c=h[3],v=this._previousPoint,x=v[0],g=v[1],D=v[2],P=v[3];(Math.hypot(l-x,u-g)>e.minDistance||p&&c&&Math.hypot(p-D,c-P)>e.minDistance)&&(i.push(h),this._previousPoint=h)}else i.push(h)}}_endLine(t,e){}_drawStroke(t,e){t.get("visible")&&!t.get("forceHidden")&&t.set("draw",i=>{E(e,a=>{this._strokeGenerator.context(i),this._strokeGenerator(a)})})}_drawFill(t,e){t.get("visible")&&!t.get("forceHidden")&&t.set("draw",i=>{E(e,a=>{this._fillGenerator.context(i),this._fillGenerator(a)})})}_processAxisRange(t){super._processAxisRange(t),t.fills=new ct(Z.new({}),()=>q._new(this._root,{themeTags:st(t.fills.template.get("themeTags",[]),["line","series","fill"])},[this.fills.template,t.fills.template])),t.strokes=new ct(Z.new({}),()=>q._new(this._root,{themeTags:st(t.strokes.template.get("themeTags",[]),["line","series","stroke"])},[this.strokes.template,t.strokes.template]))}createLegendMarker(t){const e=this.get("legendDataItem");if(e){const i=e.get("marker"),a=e.get("markerRectangle");a&&a.setPrivate("visible",!1),i.set("background",Zt.new(i._root,{fillOpacity:0,fill:ot(0)}));const n=i.children.push(q._new(i._root,{themeTags:["line","series","legend","marker","stroke"],interactive:!1},[this.strokes.template]));this._legendStroke=n;const s=i.children.push(q._new(i._root,{themeTags:["line","series","legend","marker","fill"]},[this.fills.template]));this._legendFill=s;const r=this._root.interfaceColors.get("disabled");if(n.states.create("disabled",{fill:r,stroke:r}),s.states.create("disabled",{fill:r,stroke:r}),this.bullets.length>0){const o=this.bullets.getIndex(0);if(o){const h=o(i._root,this,new pt(this,{legend:!0},{}));if(h){const l=h.get("sprite");l instanceof q&&l.states.create("disabled",{fill:r,stroke:r}),l&&(l.set("tooltipText",void 0),l.set("tooltipHTML",void 0),i.children.push(l),l.setAll({x:i.width()/2,y:i.height()/2}),i.events.on("boundschanged",()=>{l.setAll({x:i.width()/2,y:i.height()/2})}))}}}}}}Object.defineProperty(ht,"className",{enumerable:!0,configurable:!0,writable:!0,value:"LineSeries"});Object.defineProperty(ht,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Lt.classNames.concat([ht.className])});const Ot={mapAgentTargetSales:m=>{const{agentKPI:t,monthStart:e,monthEnd:i}=m;if(!t||!e||!i)return[];let a=t.budget;t.type==="quarter"&&(a=t.budget/3),t.type==="year"&&(a=t.budget/12);const n=ve(i,e)+1;return be(n,r=>({date:_e(e,r).getTime(),value:a*(r+1)}))},mergeInvoiceAndPipelineData:m=>{const{invoicedJobs:t=[],pipelineJobs:e=[]}=m,i=new Map;t.forEach(r=>i.set(r.date,r)),e.forEach(r=>i.set(r.date,(()=>{var l,u;const o=((l=i.get(r.date))==null?void 0:l.date)??r.date,h=(u=i.get(r.date))==null?void 0:u.value;return{date:o,value:h?h+r.value:r.value}})()));const a=Array.from(i.values()),n=ie(a.map(r=>{var o;return{...r,date:(o=new Date(r==null?void 0:r.date))==null?void 0:o.getTime()}}),["date"],["asc"]),s=[];return n.reduce((r,o)=>{const h=r+o.value;return s.push({...o,value:h}),h},0),s}},Te=async m=>{const{ids:t}=m;return await se({"id.keyword":t},"user",ne,{size:1e4})},Me=ae(re),Ae=async(m={})=>{var p,c,v;const{ids:t,invoiceMonthEst:e,jobStatus:i,liveJobStatuses:a,invoiceMonth:n}=m,s={"type.keyword":["LAWD_SALES"],"id.keyword":(p=et(t))!=null&&p.length?et(t):void 0,"status.keyword":(c=et(i))!=null&&c.length?et(i):void 0,"attributes.liveJobStatus.keyword":(v=et(a))!=null&&v.length?et(a):void 0},r=e?new Date(e):void 0,o=n!=null&&n.start?new Date(n==null?void 0:n.start):void 0,h=n!=null&&n.end?new Date(n==null?void 0:n.end):void 0,l=et([it(r)&&{range:{"attributes.invoiceMonthEst":{gte:lt(yt(r),"yyyy-MM-dd"),lte:lt(At(r),"yyyy-MM-dd")}}},it(r)&&{exists:{field:"attributes.invoiceMonthEst"}},(it(o)||it(h))&&{range:{"attributes.invoiceMonthEst":{gte:lt(yt(o),"yyyy-MM-dd"),lte:lt(At(h),"yyyy-MM-dd")}}},(it(o)||it(h))&&{exists:{field:"attributes.invoiceMonthEst"}}]);return await Me.find(Vt(s),{size:1e4,query:{bool:{must:l}}})},Fe=async(m={})=>{var B,V,U;const{leadAgent:t,jobIds:e,invoiceMonthEst:i,invoiceMonth:a}=m,n=await Ae({invoiceMonthEst:i,invoiceMonth:a}),s={"attributes.groups.id":e!=null&&e.length?e:void 0,"attributes.valuerId.keyword":t!=null&&t.length?t:void 0,"type.keyword":["JOB_FEE_SPLIT"]},r=oe(Vt(s)),o=await le({index:"resource",body:{size:0,query:{bool:{must_not:[{range:{"attributes.agentsFee":{lte:0}}},{range:{"attributes.weightedFee":{lte:0}}}],filter:r}},aggs:{byAgent:{terms:{field:"attributes.valuerId.keyword",size:1e4,min_doc_count:1},aggs:{byJob:{terms:{field:"groups.id.keyword",size:1e4,min_doc_count:1},aggs:{totalAmount:{sum:{field:"attributes.weightedFee"}},filterZeroAmount:{bucket_selector:{buckets_path:{totalAmount:"totalAmount.value"},script:"params.totalAmount > 0"}}}},totalAmount:{sum:{field:"attributes.weightedFee"}},filterZeroAmount:{bucket_selector:{buckets_path:{totalAmount:"totalAmount.value"},script:"params.totalAmount > 0"}}}}}}}),h=(V=(B=o==null?void 0:o.aggregations)==null?void 0:B.byAgent)==null?void 0:V.buckets,l=L.compact(L.uniq(h==null?void 0:h.map(d=>d==null?void 0:d.key))),u=await Te({ids:l}),p=L.keyBy(u==null?void 0:u.map(d=>{var f,y;return{...d,_id:(y=(f=d==null?void 0:d.id)==null?void 0:f.trim())==null?void 0:y.toLowerCase()}}),"_id"),c=L.mapValues(L.keyBy(h,"key"),d=>{var f;return{...d,jobs:L.keyBy(((f=d==null?void 0:d.byJob)==null?void 0:f.buckets)||[],"key"),agent:p==null?void 0:p[d==null?void 0:d.key]}}),v=(U=n==null?void 0:n.map(d=>({...d,__invoiceStartMonthEst:d!=null&&d.invoiceMonthEst&&it(new Date(d==null?void 0:d.invoiceMonthEst))?lt(yt(d==null?void 0:d.invoiceMonthEst),"yyyy-MM-dd"):"invalid"})))==null?void 0:U.filter(d=>(d==null?void 0:d.__invoiceStartMonthEst)!=="invalid"),x=v==null?void 0:v.filter(d=>d.liveJobStatus==="invoiced"),g=v==null?void 0:v.filter(d=>d.liveJobStatus!=="invoiced"),D=L.groupBy(x,"__invoiceStartMonthEst"),P=L.groupBy(g,"__invoiceStartMonthEst");return u==null?void 0:u.map(d=>{var Y,_,k,T,C,X,Q,w,z,K;const f=c==null?void 0:c[(_=(Y=d==null?void 0:d.id)==null?void 0:Y.toLowerCase())==null?void 0:_.trim()];let y=0;const O=(k=Object.entries(D))==null?void 0:k.map(([M,A])=>{const J=A==null?void 0:A.map(G=>{var $,W,nt,at,rt;const b=(nt=f==null?void 0:f.jobs)==null?void 0:nt[(W=($=G==null?void 0:G.id)==null?void 0:$.toLowerCase())==null?void 0:W.trim()];return(at=b==null?void 0:b.totalAmount)!=null&&at.value&&y++,{date:G.__invoiceStartMonthEst,value:((rt=b==null?void 0:b.totalAmount)==null?void 0:rt.value)||0}});return{date:M,value:L.sumBy(J,"value")}}),I=(T=Object.entries(P))==null?void 0:T.map(([M,A])=>{const J=A==null?void 0:A.map(G=>{var $,W,nt,at,rt;if(G.liveJobStatus==="lost")return;const b=(nt=f==null?void 0:f.jobs)==null?void 0:nt[(W=($=G==null?void 0:G.id)==null?void 0:$.toLowerCase())==null?void 0:W.trim()];return(at=b==null?void 0:b.totalAmount)!=null&&at.value&&y++,{date:G.__invoiceStartMonthEst,value:((rt=b==null?void 0:b.totalAmount)==null?void 0:rt.value)||0}});return{date:M,value:L.sumBy(L.compact(J),"value")}});return{totalJobs:y,agentKPI:{type:(Q=(X=(C=d==null?void 0:d.kpi)==null?void 0:C.items)==null?void 0:X.salesTarget)==null?void 0:Q.period,budget:(K=(z=(w=d==null?void 0:d.kpi)==null?void 0:w.items)==null?void 0:z.salesTarget)==null?void 0:K.target},invoicedJobs:L.orderBy(O==null?void 0:O.filter(M=>!!(M!=null&&M.value)),["date"]),pipelineJobs:L.orderBy(I==null?void 0:I.filter(M=>!!(M!=null&&M.value)),["date"]),agent:d,id:d==null?void 0:d.id}})};function Jt(){const[{agent:m,invPipeMonthStart:t,invPipeMonthEnd:e},i]=ue({agent:he,invPipeMonthStart:kt,invPipeMonthEnd:kt}),a=s=>{if(!s){i({invPipeMonthStart:void 0,invPipeMonthEnd:void 0});return}const{startDate:r,endDate:o}=s;i({invPipeMonthStart:r,invPipeMonthEnd:o})},{data:n}=ce({queryKey:["AGENT_ACTIVITY_REPORT_INVOICE_AND_PIPELINES_CHART_DATA",{agent:m,invPipeMonthStart:t,invPipeMonthEnd:e}],queryFn:async()=>{if(!m||!t||!e)return;const[s]=await Fe({leadAgent:[m],invoiceMonth:{start:t,end:e}});return s}});return console.log("@AGENT_ACTIVITY_REPORT_INVOICE_AND_PIPELINES_CHART_DATA::",n),Wt.useLayoutEffect(()=>{if(!n)return;const s=Kt.new("invoice-and-pipelines-line-chart"),r=$t.new(s);r.rule("AxisLabel",["minor"]).setAll({dy:1}),r.rule("Grid",["minor"]).setAll({strokeOpacity:.08}),s.setThemes([te.new(s),r]),s!=null&&s._logo&&s._logo.dispose();const o=s.container.children.push(xe.new(s,{panX:!0,panY:!0,wheelY:"zoomXY",paddingLeft:0,layout:s.verticalLayout}));o.set("cursor",we.new(s,{behavior:"zoomX"})).lineY.set("visible",!1),new Date().setHours(0,0,0,0);const u=o.xAxes.push(ft.new(s,{maxDeviation:0,baseInterval:{timeUnit:"day",count:1},renderer:De.new(s,{minorGridEnabled:!0,minGridDistance:100,minorLabelsEnabled:!0}),tooltip:_t.new(s,{})}));u.get("dateFormats").month="MMMM";const p=o.yAxes.push(xt.new(s,{renderer:Pe.new(s,{})})),c=o.series.push(ht.new(s,{name:"Budget",xAxis:u,yAxis:p,valueYField:"value",valueXField:"date",tooltip:_t.new(s,{labelText:"${valueY}"}),fill:ot(13467442),stroke:ot(13467442)})),v=o.series.push(ht.new(s,{name:"Actual/Pipeline",xAxis:u,yAxis:p,valueYField:"value",valueXField:"date",tooltip:_t.new(s,{labelText:"${valueY}"}),fill:ot(1592986),stroke:ot(1592986)}));c.bullets.push(function(){const S=ut.new(s,{radius:5,fill:c.get("fill")});return St.new(s,{sprite:S})}),v.bullets.push(function(){const S=ut.new(s,{radius:5,fill:v.get("fill")});return St.new(s,{sprite:S})}),o.set("scrollbarX",gt.new(s,{orientation:"horizontal"})),o.children.push(Ie.new(s,{centerX:It,x:It})).data.setAll(o.series.values);const g=n||[],D=Ot.mapAgentTargetSales({agentKPI:g==null?void 0:g.agentKPI,monthStart:t,monthEnd:e}),P=Ot.mergeInvoiceAndPipelineData({invoicedJobs:g==null?void 0:g.invoicedJobs,pipelineJobs:g==null?void 0:g.pipelineJobs});return c.data.setAll(D),v.data.setAll(P),c.appear(1e3),v.appear(1e3),o.appear(1e3,100),()=>s.dispose()},[n]),j.jsxs(de,{sx:{borderRadius:"4px",p:4,display:"flex",flexDirection:"column"},children:[j.jsxs(Tt,{sx:s=>({pb:2,pr:8,display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",borderBottom:`1px solid ${s.palette.text.disabled}`}),children:[j.jsxs(pe,{direction:"row",alignItems:"center",columnGap:2.5,children:[j.jsx(Mt,{component:"h6",fontWeight:900,children:"Invoiced & Pipeline"}),j.jsx(ge,{onChange:a,defaultDateRange:t&&e?{startDate:t,endDate:e}:void 0,variant:"outlined",label:"Period",InputLabelProps:{shrink:!0},zIndex:9999,sx:{width:300,"& input":{fontSize:14},"& label":{mt:"10px"}}})]}),j.jsxs(Mt,{component:"h6",fontWeight:900,children:["Total Number: ",(n==null?void 0:n.totalJobs)??""]})]}),!m||!t||!e?j.jsx(ee,{message:"Please fill the agent & period filters accordingly."}):j.jsx(Tt,{id:"invoice-and-pipelines-line-chart",sx:{width:1,height:800}})]})}const $e={title:"LAWD/User View Invoice & Pipelines Chart",component:Jt},Se=new fe,dt={render:()=>j.jsx(me,{client:Se,children:j.jsx(Jt,{})})};var Ct,Et,Gt;dt.parameters={...dt.parameters,docs:{...(Ct=dt.parameters)==null?void 0:Ct.docs,source:{originalSource:`{
  render: () => <QueryClientProvider client={queryClient}>
      <InvoiceAndPipelinesChart />
    </QueryClientProvider>
}`,...(Gt=(Et=dt.parameters)==null?void 0:Et.docs)==null?void 0:Gt.source}}};const ti=["Default"];export{dt as Default,ti as __namedExportsOrder,$e as default};
