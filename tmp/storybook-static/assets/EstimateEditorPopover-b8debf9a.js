import{j as l}from"./TransitionGroupContext-9d36972e.js";import{R as u}from"./index-f1f749bf.js";import{$ as v,b as h,B as c,bz as b,X as E,i as j,C as k,h as w,r as C,c as y}from"./papaparse.min-b66e70e7.js";import{d as S}from"./Check-78df5e8e.js";function P(e){const{selector:t,children:n,...o}=e,i=u.useRef(null);return v(async r=>{if(!i.current||(await h.delay(500),!r()))return;const s=i.current.querySelectorAll(t);for(const d of s)d.focus()},[t]),l.jsx(c,{...o,ref:i,children:n})}function V(e){return l.jsx(P,{selector:"input",children:l.jsx(w,{sx:{width:250,fontSize:10},fullWidth:!0,label:e.label,value:e.value||"",onChange:e.onChange,onFocus:t=>{t.target.select()},onKeyDown:t=>{t.key==="Enter"&&e.onSubmit()}})})}function _(e){const[t,n]=u.useState({saving:!1,newValue:null}),o=(a,m)=>{var g;let f;m?f=m:(g=a.target)!=null&&g.value&&(f=a.target.value),n(x=>({...x,newValue:f}))},i=async()=>{s&&(n(a=>({...a,saving:!0})),await Promise.resolve(e.onSave(t.newValue)),n(a=>({...a,saving:!1})))};u.useEffect(()=>{e.value&&n(a=>({...a,newValue:e.value}))},[]);const r=u.useMemo(()=>e.isValidCheck?b(t.newValue):!0,[t.newValue]),s=t.newValue!==null,d=e.renderEditor||V;return l.jsxs(c,{sx:{display:"flex",flex:1,p:1,alignItems:"center"},onClick:a=>{a.stopPropagation()},children:[d({label:e.label,value:t.newValue===null?e.value:t.newValue,onChange:o,onSubmit:i}),l.jsx(c,{ml:1,children:l.jsx(E,{title:"Submit",children:l.jsx(c,{sx:{position:"relative"},children:l.jsxs(j,{size:"small",disabled:t.saving||!s||!r,sx:{backgroundColor:s?"success.light":"lightgrey",color:"white","&:hover":{backgroundColor:"success.main"}},onClick:async a=>{a.stopPropagation(),i()},children:[l.jsx(S,{}),t.saving&&l.jsx(k,{size:35,sx:{color:"warning.light",position:"absolute",zIndex:1}})]})})})})]})}function F(e){const{editor:t,...n}=e;return l.jsx(C,{...n,onBackdropClick:o=>{var i;return o.stopPropagation(),(i=n.onBackdropClick)==null?void 0:i.call(n,o)},children:l.jsx(_,{...t})})}function z(e){return{save:async t=>{await y([{__op:"update",__typename:e.model,__fields:e.fieldName,id:e.id,[e.fieldName]:t||null}])}}}function B(e){const{taskId:t,estimatedEffort:n,...o}=e,i=z({id:t,fieldName:"estimatedEffort",model:"Task"});return l.jsx(F,{...o,editor:{label:"Estimate",value:n||8,isValidCheck:!0,async onSave(r){var s;console.log(">>task-link-actions/EstimateEditorPopover::","value",r),await i.save(r),(s=e.onClose)==null||s.call(e,{},"backdropClick")}}})}const R=Object.freeze(Object.defineProperty({__proto__:null,default:B},Symbol.toStringTag,{value:"Module"}));export{P as A,B as E,F as S,R as a,z as u};
