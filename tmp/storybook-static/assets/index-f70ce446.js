import{j as L}from"./TransitionGroupContext-9d36972e.js";import{r as c,R as _}from"./index-f1f749bf.js";import{u as z}from"./index.esm-bf21a293.js";import{l as B}from"./index-bcfaa842.js";import{A as N,h as O,C as V}from"./papaparse.min-b66e70e7.js";const p=(y,n)=>{const M=typeof n=="string"?n:(n==null?void 0:n.value)??"";return y.value===M};function J({customRenderOption:y,control:n,name:h,rules:M,textFieldProps:g,defaultValue:x,onOptionSelected:I,options:T,loading:C,customRenderInput:m,...v}){const{isOptionEqualToValue:F=p}=v,t=c.useMemo(()=>B.keyBy(T,"value"),[T]),{field:u,fieldState:s}=z({name:h,control:n,defaultValue:x,rules:M}),i=c.useMemo(()=>(u==null?void 0:u.value)||x,[x,u==null?void 0:u.value]),l=c.useMemo(()=>Array.isArray(i)?i==null?void 0:i.map(e=>(t==null?void 0:t[e])??e):(t==null?void 0:t[i])??i,[t,i]),R=c.useCallback((e,r,A)=>{I==null||I(e,r,A);let b=r;return r&&typeof r=="object"&&"value"in r?b=r.value:Array.isArray(r)&&(b=r.map(E=>typeof E=="string"?E:E.value)),console.log("FORM_AUTOCOMPLETE_ON_CHANGE",b,r,n),u==null?void 0:u.onChange(b)},[u,I,n]),o=c.useMemo(()=>(v.multiple&&l&&!(l!=null&&l.filter),l),[l,v.multiple]);s.error&&console.error("FormAutocomplete>>name, error, value:",h,s.error,u==null?void 0:u.value);const U=(e,r)=>{let A=null;return(c.isValidElement(r)||["boolean","number","string","undefined"].includes(typeof r)||r===null)&&(A=r),c.createElement("li",{...e,key:(r==null?void 0:r.id)||r},(r==null?void 0:r.label)||A||`[nolabel]@${r.value}`)};return L.jsx(N,{...v,value:o??void 0,options:T,isOptionEqualToValue:F,getOptionLabel:e=>e.label??e,renderOption:y||U,onChange:R,loading:C,renderInput:e=>{var r,A,b,E,f,j,k;if(m)return _.cloneElement(m,{...e,InputLabelProps:{shrink:!0}});{const P=(r=e==null?void 0:e.inputProps)!=null&&r.value?(A=e==null?void 0:e.inputProps)==null?void 0:A.value:Array.isArray(o)?(b=o==null?void 0:o.filter(Boolean))==null?void 0:b.map(q=>q.label).join(", "):o==null?void 0:o.label;return console.log("AUTOCOMPLETE_PARAMS",{params:e,currentOption:l,currentValue:o,field:u,defaultValue:x,inputValue:P,textFieldProps:g}),console.log("TEST_INPUT_VALUE",{inputValue:P,inputPropsValue:(E=e==null?void 0:e.inputProps)==null?void 0:E.value,fieldValue:u==null?void 0:u.value,currentOption:l}),L.jsx(O,{...e,...g,inputProps:{...e==null?void 0:e.inputProps,value:C?P===(u==null?void 0:u.value)?(l==null?void 0:l.label)||"":P:P===void 0||v.multiple?"":P},disabled:C,name:h,error:!!(s!=null&&s.error),helperText:((f=s==null?void 0:s.error)==null?void 0:f.message)??"",InputLabelProps:{shrink:!0},InputProps:{...e.InputProps,...g.InputProps,endAdornment:L.jsxs(_.Fragment,{children:[C?L.jsx(V,{color:"inherit",size:20}):null,((j=g.InputProps)==null?void 0:j.endAdornment)||((k=e==null?void 0:e.InputProps)==null?void 0:k.endAdornment)]})},sx:{mt:"10px","> .MuiFormLabel-root.MuiFormLabel-root":{fontSize:"1rem"},"> .MuiInputLabel-root:not(.MuiInputLabel-shrink)":{top:"-3px",fontSize:"small"},".MuiInputBase-input":{padding:"0px!important"}}})}}})}export{J as F};
